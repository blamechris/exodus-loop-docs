{"developer-guide/architecture":{"slug":"developer-guide/architecture","filePath":"developer-guide/architecture.md","title":"Architecture","links":["developer-guide/screens"],"tags":[],"content":"Architecture\nExodus Loop follows a singleton-based architecture with signal-driven communication between systems.\nAutoload Singletons\ngraph TD\n    GameState[GameState&lt;br/&gt;Central state management]\n    SaveManager[SaveManager&lt;br/&gt;Persistence]\n    CombatResolver[CombatResolver&lt;br/&gt;Combat logic - stateless]\n    DiceSystem[DiceSystem&lt;br/&gt;RNG and dice rolls]\n    AudioManager[AudioManager&lt;br/&gt;SFX and music]\n    AccessibilityManager[AccessibilityManager&lt;br/&gt;Colorblind, text size, etc.]\n\n    GameState --&gt; SaveManager\n    GameState --&gt; CombatResolver\n    CombatResolver --&gt; DiceSystem\n\nAdditional Singletons\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSingletonPurposeAudioManagerSFX pool (8 concurrent), music with fadeHapticsManagerTouch feedback and vibration patternsAccessibilityManagerColorblind mode, text scaling, screen readerStatisticsManagerCareer/battle/run stat trackingAchievementManagerAchievement unlock tracking\nGameState (game_state.gd)\nResponsibility: Central state management for runs and meta-progression\nKey Data:\n\nsquadron_roster: Array[Squadron] - Player squadrons\npilot_roster: Array[Pilot] - Available pilots\nenemy_roster: Array[Enemy] - Current battle enemies\nmeta_xp: int - Cross-run currency\nunlocked_upgrades: Array[String] - Purchased upgrades\ncurrent_admiral: Admiral - Player’s admiral\n\nKey Methods:\n# Grid helpers\nis_valid_cell(pos: Vector2i) -&gt; bool\nget_adjacent_cells(pos: Vector2i) -&gt; Array[Vector2i]\nget_distance(from: Vector2i, to: Vector2i) -&gt; int\nget_cell_name(pos: Vector2i) -&gt; String\n \n# State management\nstart_new_run() -&gt; void\nend_run(victory: bool) -&gt; void\npurchase_upgrade(id: String) -&gt; bool\nSaveManager (save_manager.gd)\nResponsibility: JSON-based persistence\nSave Types:\n\nMeta saves: XP, unlocks, admiral, blessed squadrons (persistent)\nRun saves: Current run state (cleared on completion)\n\nKey Methods:\nsave_meta_state() -&gt; void\nload_meta_state() -&gt; bool\nsave_run_state() -&gt; void\nload_run_state() -&gt; bool\nhas_saved_run() -&gt; bool\nCombatResolver (combat_resolver.gd)\nResponsibility: Stateless combat resolution\nKey Methods:\nget_all_contested_cells() -&gt; Array[Vector2i]\nresolve_cell_combat(cell_pos: Vector2i) -&gt; CombatLog\ncheck_interception(squad, from, to) -&gt; InterceptionResult\nresolve_interception(result: InterceptionResult) -&gt; void\nDiceSystem (dice_system.gd)\nResponsibility: All RNG operations\nKey Methods:\nroll_initiative(spd: int) -&gt; DiceRoll\nroll_damage(atk: int, def: int, die_type: DiceType) -&gt; DiceRoll\nroll_combat_damage(attacker: Squadron, defender: Squadron) -&gt; DiceRoll\nget_rps_die(attacker_type: int, defender_type: int) -&gt; DiceType\n\nEntity Hierarchy\nclassDiagram\n    class Squadron {\n        +id: int\n        +type: SquadronType\n        +hull: int\n        +grid_pos: Vector2i\n        +assigned_pilot_id: int\n        +take_damage(amount)\n        +get_effective_atk()\n        +get_effective_def()\n    }\n\n    class Enemy {\n        +squadron: Squadron\n        +intent: Intent\n        +aggression: float\n        +set_intent()\n        +execute_intent()\n    }\n\n    class Pilot {\n        +id: int\n        +name: String\n        +perks: Array\n        +level: int\n        +morale: int\n        +add_xp(amount)\n        +modify_morale(delta)\n    }\n\n    class Carrier {\n        +hp: int\n        +grid_pos: Vector2i\n        +hangar: Array\n        +take_damage(amount)\n        +launch_squadron(squad)\n        +land_squadron(squad)\n    }\n\n    class Admiral {\n        +level: int\n        +xp: int\n        +skill_tree: SkillTree\n        +unlocked_skills: Array\n        +get_skill_value(stat)\n    }\n\n    Enemy --&gt; Squadron : wraps\n    Squadron --&gt; Pilot : assigned to\n    Admiral --&gt; SkillTree : has\n\n\nSignal Flow\nsequenceDiagram\n    participant Screen\n    participant GameState\n    participant SaveManager\n\n    Screen-&gt;&gt;GameState: squadron_deployed(squad)\n    GameState-&gt;&gt;GameState: Update roster\n    GameState-&gt;&gt;Screen: squadron_state_changed\n\n    Screen-&gt;&gt;GameState: end_turn()\n    GameState-&gt;&gt;CombatResolver: resolve_all_combat()\n    CombatResolver-&gt;&gt;GameState: combat_results\n    GameState-&gt;&gt;Screen: battle_state_changed\n    GameState-&gt;&gt;SaveManager: save_run_state()\n\nKey Signals\nGameState:\nsignal squadron_deployed(squadron: Squadron)\nsignal squadron_destroyed(squadron: Squadron)\nsignal turn_ended(turn_number: int)\nsignal battle_started()\nsignal battle_ended(victory: bool)\nsignal run_ended(victory: bool, stats: Dictionary)\nsignal upgrade_purchased(upgrade_id: String)\nScreen Navigation:\nsignal screen_change_requested(screen_name: String, params: Dictionary)\n\nScreen Navigation\nScreens communicate with main.gd via signals:\n# In any screen\nsignal screen_change_requested(screen_name: String, params: Dictionary)\n \n# Request transition\nscreen_change_requested.emit(&quot;battle&quot;, {&quot;node_id&quot;: node_id})\n \n# main.gd handles the transition\nfunc _on_screen_change_requested(name: String, params: Dictionary) -&gt; void:\n    _transition_to_screen(name, params)\nSee Screen Navigation for the full state machine.\n\nCode Patterns\nGrid Position Helpers\n# Check if position is valid\nif GameState.is_valid_cell(pos):\n    # Safe to use position\n \n# Get adjacent cells\nvar neighbors = GameState.get_adjacent_cells(pos)\n \n# Get Manhattan distance\nvar dist = GameState.get_distance(from_pos, to_pos)\n \n# Get cell name (A1, B2, etc.)\nvar name = GameState.get_cell_name(pos)\nEntity Lifecycle\n# Creating entities\nvar squadron = Squadron.new()\nsquadron.initialize(type, grid_pos)\nGameState.squadron_roster.append(squadron)\n \n# Destroying entities\nfunc _on_squadron_destroyed(squadron: Squadron) -&gt; void:\n    GameState.remove_squadron(squadron)\n    squadron.queue_free()\nAction Assignment\n# Assign action to squadron\nsquadron.pending_action = Squadron.Action.ATTACK\nsquadron.pending_target_pos = target_pos\n \n# Clear on resolution\nfunc _clear_all_actions() -&gt; void:\n    for squad in GameState.squadron_roster:\n        squad.pending_action = Squadron.Action.NONE\n        squad.pending_target_pos = Vector2i(-1, -1)\n\nFile Organization\nAdding New Screens\n\nCreate src/screens/name/name_screen.gd\nCreate src/screens/name/name_screen.tscn\nAdd to main.gd screen loader\nEmit screen_change_requested signal to navigate\n\nAdding New Components\n\nCreate src/ui/components/name.gd\nCreate src/ui/components/name.tscn\nUse class_name for easy referencing\n\nAdding New Entities\n\nCreate src/entities/name.gd\nFollow existing entity patterns (id, serialization)\nAdd to relevant roster in GameState\n\n\nCore Systems\nShip Builder V2\nThe polyomino-based carrier construction system:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFilePurposesrc/data/carrier/carrier_class_template.gdClass definitions and guaranteed piecessrc/systems/ship_builder/ship_configuration_v2.gdComponent placement and validationsrc/systems/ship_builder/directional_damage.gdSector-based damage calculationsrc/systems/collision/capital_collision.gdShip-to-ship collision handling\nComponent Draw Manager\nHandles component pool for each run:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFilePurposesrc/systems/component_draw/component_draw_manager.gdRun-start component drawingsrc/data/fleet/exodus_fleet.gdPersistent fleet extraction\nReinforcement System\nControls multi-wave encounters:\n\n\n\n\n\n\n\n\n\n\n\n\n\nFilePurposesrc/systems/reinforcement_manager.gdWave triggers and spawning\nCrafting System\nBlueprint-based component crafting:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFilePurposesrc/data/crafting/blueprint_registry.gdAll available blueprintssrc/systems/crafting/build_queue_manager.gdBuild queue (max 3)src/systems/crafting/blueprint_drop_calculator.gdDrop chance calculation\n\nKey Data Classes\nDrawnComponent\nComponent drawn for current run:\nclass DrawnComponent:\n    var component_type: ComponentType\n    var shape: ShapeType\n    var rarity: Rarity\n    var traits: Array[String]\n    var source: String  # &quot;guaranteed&quot;, &quot;bonus_draw&quot;, &quot;exodus_fleet&quot;\nExtractedComponent\nComponent saved to Exodus Fleet:\nclass ExtractedComponent:\n    var id: String\n    var component_type: ComponentType\n    var rarity: Rarity\n    var damage_percent: float\n    var extraction_run_id: String\nWaveConfig\nReinforcement wave configuration:\nclass WaveConfig:\n    var trigger: WaveTrigger\n    var trigger_value: int\n    var fighter_count: int\n    var spawn_position: SpawnPosition"},"developer-guide/combat-system":{"slug":"developer-guide/combat-system","filePath":"developer-guide/combat-system.md","title":"Combat Implementation","links":["game-design/combat","internal/tech-debt"],"tags":[],"content":"Combat Implementation\nTechnical documentation for the combat system implementation.\n\nNote: As of v0.5.30, single-occupancy tactical combat is enabled by default (battle_state.single_occupancy_enabled = true). This changes movement blocking, dogfight resolution, and weapon behavior. See Single-Occupancy Tactical Mode for gameplay details.\n\nFile Locations\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFilePurposesrc/autoload/combat_resolver.gdCore combat logicsrc/autoload/dice_system.gdDice rolls and RNGsrc/screens/battle/battle_screen.gdPhase management, UIsrc/entities/squadron.gdUnit stats, effective values\n\nResolution Flow\nsequenceDiagram\n    participant BS as BattleScreen\n    participant CR as CombatResolver\n    participant DS as DiceSystem\n    participant SQ as Squadron\n\n    BS-&gt;&gt;BS: _execute_resolution()\n    BS-&gt;&gt;BS: _execute_launches()\n    BS-&gt;&gt;BS: _execute_enemy_intents()\n    BS-&gt;&gt;BS: _execute_carrier_action()\n    BS-&gt;&gt;BS: _execute_movements()\n    BS-&gt;&gt;BS: _execute_landings()\n\n    BS-&gt;&gt;CR: get_all_contested_cells()\n    CR--&gt;&gt;BS: Array[Vector2i]\n\n    loop For each contested cell\n        BS-&gt;&gt;CR: resolve_cell_combat(cell_pos)\n        CR-&gt;&gt;DS: roll_initiative(spd)\n        DS--&gt;&gt;CR: DiceRoll\n\n        loop For each attacker in initiative order\n            CR-&gt;&gt;SQ: get_effective_atk()\n            SQ--&gt;&gt;CR: int\n            CR-&gt;&gt;SQ: get_effective_def()\n            SQ--&gt;&gt;CR: int\n            CR-&gt;&gt;DS: roll_combat_damage(attacker, defender)\n            DS--&gt;&gt;CR: DiceRoll\n            CR-&gt;&gt;SQ: take_damage(amount)\n        end\n\n        CR--&gt;&gt;BS: CombatLog\n    end\n\n    BS-&gt;&gt;BS: _apply_carrier_damage()\n    BS-&gt;&gt;BS: _clear_all_actions()\n\n\nInitiative System\nFile: combat_resolver.gd:148-175\nfunc resolve_cell_combat(cell_pos: Vector2i) -&gt; CombatLog:\n    var combat_log = CombatLog.new()\n    combat_log.cell_pos = cell_pos\n \n    # Gather all units in cell\n    var all_units: Array = []\n    for squad in GameState.squadron_roster:\n        if squad.grid_pos == cell_pos:\n            all_units.append(squad)\n    for enemy in GameState.enemy_roster:\n        if enemy.squadron.grid_pos == cell_pos:\n            all_units.append(enemy.squadron)\n \n    # Roll initiative for each\n    var initiatives: Array = []\n    for unit in all_units:\n        var roll = DiceSystem.roll_initiative(unit.spd)\n        initiatives.append({\n            &quot;unit&quot;: unit,\n            &quot;roll&quot;: roll.total,\n            &quot;spd&quot;: unit.spd\n        })\n \n    # Sort by roll (desc), then spd (desc)\n    initiatives.sort_custom(func(a, b):\n        if a.roll != b.roll:\n            return a.roll &gt; b.roll\n        return a.spd &gt; b.spd\n    )\n \n    combat_log.initiative_order = initiatives\n    # Continue with attack resolution...\n\nDamage Calculation\nFile: dice_system.gd:88-112\nstatic func roll_combat_damage(attacker: Squadron, defender: Squadron) -&gt; DiceRoll:\n    # Determine die type from RPS relationship\n    var die_type = get_rps_die(attacker.type, defender.type)\n \n    # Get effective stats\n    var atk = attacker.get_effective_atk()\n    var def = defender.get_effective_def()\n \n    # Roll the die\n    var roll = DiceRoll.new(die_type, atk)\n    roll.base_roll = randi_range(1, die_type)\n \n    # Calculate damage\n    roll.total = maxi(0, roll.base_roll + atk - def)\n \n    return roll\n \nstatic func get_rps_die(attacker_type: int, defender_type: int) -&gt; DiceType:\n    # Frigate always neutral\n    if attacker_type == Squadron.SquadronType.FRIGATE or \\\n       defender_type == Squadron.SquadronType.FRIGATE:\n        return DiceType.D6\n \n    # Check advantage\n    var advantage = Squadron.TYPE_ADVANTAGE\n    if advantage.get(attacker_type) == defender_type:\n        return DiceType.D10  # Attacker has advantage\n    elif advantage.get(defender_type) == attacker_type:\n        return DiceType.D4   # Attacker has disadvantage\n    else:\n        return DiceType.D6   # Neutral\n\nEffective Stats\nFile: squadron.gd:438-546\nfunc get_effective_atk() -&gt; int:\n    var effective = atk\n \n    # Action modifiers\n    if pending_action == Action.ATTACK:\n        effective += 1\n    elif pending_action == Action.DEFEND:\n        effective += 1\n \n    # Pilot bonuses\n    effective += _get_pilot_stat_bonus(&quot;atk&quot;)\n    effective += _get_pilot_morale_modifier(&quot;atk&quot;)\n \n    # Trait bonuses\n    effective += _get_trait_atk_bonus()\n \n    # Admiral bonuses (player only)\n    if not is_enemy:\n        effective += _get_admiral_atk_bonus()\n \n    # Fire Control Network\n    effective += _get_fire_control_bonus()\n \n    # Grid position modifiers\n    if is_on_grid():\n        effective += GameState.get_accuracy_modifier(grid_pos)\n \n    return effective\n \nfunc get_effective_def() -&gt; int:\n    var effective = def\n \n    # Action modifiers\n    if pending_action == Action.DEFEND:\n        effective += 2\n \n    # Pilot bonuses\n    effective += _get_pilot_stat_bonus(&quot;def&quot;)\n    effective += _get_pilot_morale_modifier(&quot;def&quot;)\n \n    # Passive abilities\n    if _get_pilot_passive_effect(&quot;last_stand&quot;) and hull * 2 &lt;= max_hull:\n        effective += 2\n \n    # Trait bonuses\n    effective += _get_trait_def_bonus()\n \n    # Hazard bonuses\n    if is_on_grid():\n        effective += GameState.get_hazard_def_bonus(grid_pos)\n \n    return effective\n\nFire Control Network\nFile: squadron.gd:691-724\nfunc _get_fire_control_bonus() -&gt; int:\n    var bonus: int = 0\n \n    # Must be on grid\n    if not is_on_grid():\n        return 0\n \n    # Find adjacent Frigates in DEFEND mode\n    for squadron in GameState.squadron_roster:\n        # Skip self\n        if squadron == self:\n            continue\n \n        # Must be Frigate\n        if squadron.type != SquadronType.FRIGATE:\n            continue\n \n        # Must be same team\n        if squadron.is_enemy != is_enemy:\n            continue\n \n        # Must be in DEFEND mode\n        if squadron.pending_action != Action.DEFEND:\n            continue\n \n        # Must be on grid\n        if not squadron.is_on_grid():\n            continue\n \n        # Must be adjacent (Manhattan distance = 1)\n        if GameState.get_distance(grid_pos, squadron.grid_pos) == 1:\n            bonus += 1\n \n    return bonus\n\nDestroyer Torpedo Salvo\nFile: combat_resolver.gd:268-295\nfunc _resolve_attack(attacker: Squadron, defender: Squadron) -&gt; DogfightResult:\n    var result = DogfightResult.new()\n    result.attacker = attacker\n    result.defender = defender\n \n    # Roll damage\n    result.attacker_roll = DiceSystem.roll_combat_damage(attacker, defender)\n \n    # Destroyer armor piercing\n    if attacker.type == Squadron.SquadronType.DESTROYER:\n        result.armor_piercing = 1\n        var ignored_def = mini(result.armor_piercing, defender.get_effective_def())\n        result.damage_to_defender += ignored_def\n \n    # Apply damage\n    result.damage_to_defender += result.attacker_roll.total\n    defender.take_damage(result.damage_to_defender)\n    result.defender_destroyed = defender.hull &lt;= 0\n \n    # Torpedo splash damage\n    if attacker.type == Squadron.SquadronType.DESTROYER:\n        var adjacent_enemies = _get_adjacent_enemies(defender.grid_pos, attacker.is_enemy)\n        for enemy in adjacent_enemies:\n            enemy.take_damage(1)\n            result.splash_targets.append(enemy)\n \n    return result\n\nInterception System\nFile: combat_resolver.gd:553-661\nfunc check_interception(squad: Squadron, from: Vector2i, to: Vector2i) -&gt; InterceptionResult:\n    var result = InterceptionResult.new()\n    result.moving_unit = squad\n    result.from_pos = from\n    result.to_pos = to\n \n    # Get path cells\n    var path = _get_path_cells(from, to)\n \n    # Check each cell for interceptors\n    for cell in path:\n        var interceptors = _get_interceptors_at_cell(cell, squad.is_enemy)\n        if interceptors.size() &gt; 0:\n            result.intercepted = true\n            result.intercept_cell = cell\n            result.interceptor = interceptors[0]  # First interceptor\n            break\n \n    return result\n \nfunc _get_interceptors_at_cell(cell: Vector2i, target_is_enemy: bool) -&gt; Array:\n    var interceptors: Array = []\n \n    # Check player squadrons\n    if target_is_enemy:\n        for squad in GameState.squadron_roster:\n            if squad.grid_pos == cell and _can_intercept(squad):\n                interceptors.append(squad)\n \n    # Check enemy squadrons\n    else:\n        for enemy in GameState.enemy_roster:\n            if enemy.squadron.grid_pos == cell and _can_intercept(enemy.squadron):\n                interceptors.append(enemy.squadron)\n \n    return interceptors\n \nfunc _can_intercept(squad: Squadron) -&gt; bool:\n    return squad.pending_action in [Action.ATTACK, Action.DEFEND] and \\\n           squad.ammo &gt; 0\n\nGDD Divergence: Sequential vs Simultaneous\nImportant: The original GDD specified simultaneous combat resolution, but the implementation uses sequential (initiative-based) resolution.\nRationale:\n\nSequential combat creates more tactical depth\nInitiative (SPD) becomes meaningful stat\nEliminates “mutual destruction” scenarios\nEasier to debug and display\n\nImpact:\n\nHigh-SPD units can kill before taking damage\nDead units don’t attack\nInitiative ties resolved by base SPD\n\nSee Tech Debt for tracking this divergence.\n\nSingle-Occupancy Mode Implementation\nFile: src/scripts/intent_battle/battle_state.gd\n# Feature flag (enabled by default as of v0.5.30)\nvar single_occupancy_enabled: bool = true\n \n# Debug logging for combat tracing\nvar debug_combat_tracing: bool = false\nCell Occupancy API\nfunc is_cell_occupied_by_ship(pos: Vector2i) -&gt; bool\n    # Returns true if any living ship occupies the cell\n \nfunc get_ship_at_cell(pos: Vector2i) -&gt; ShipState\n    # Returns the ship at position, or null if empty\n    # Uses O(1) cache for performance\n \nfunc can_enter_cell(mover_id: String, pos: Vector2i) -&gt; bool\n    # Returns true if ship can move to cell\n    # Blocked if single_occupancy_enabled AND cell occupied by other ship\nMovement Blocking\nFile: src/scripts/intent_battle/turn_resolver.gd\nWhen single_occupancy_enabled:\n\nBlocked ships stay in place (no bouncing)\nFacing is preserved (no forced rotation)\nCell occupancy cache rebuilt at turn start\n\nMBM Disable\nstatic func detect_mbm_engagements(state: BattleState) -&gt; Array[Dictionary]:\n    if state.single_occupancy_enabled:\n        return []  # No same-cell encounters\nWeapon Cooldowns\nclass Weapon:\n    var cooldown_max: int = 0      # 0 = fires every turn\n    var cooldown_remaining: int = 0\n \n    func can_fire() -&gt; bool        # Returns true if cooldown == 0\n    func fire() -&gt; void            # Sets cooldown_remaining = cooldown_max\n    func tick_cooldown() -&gt; void   # Called end-of-turn\nTactical Dogfight Resolution\nAdjacent ship combat resolved in _resolve_tactical_dogfight():\n\nTriggered when adjacent ships both fire at each other\nDamage applied immediately (no modal)\nDogfightEvent emitted with results\n"},"developer-guide/creative-mode":{"slug":"developer-guide/creative-mode","filePath":"developer-guide/creative-mode.md","title":"Creative Mode","links":[],"tags":[],"content":"Creative Mode\nCreative Mode is a sandbox/testing feature that enables controlling both teams during Intent Battle. Useful for testing game systems, balance tuning, and manual E2E testing.\nEnabling Creative Mode\n\nOpen Fleet Setup screen\nClick the Creative toggle button in the header (turns gold when enabled)\nLoad a preset or configure your battle\nClick Start Battle\n\n\nCreative Mode Controls\nWhen Creative Mode is active, a control panel appears in the battle screen:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nControlActionSWITCH TEAM [Tab]Toggle control between Team A and Team BReveal FogShow all hidden enemy unitsDetection OverlayVisualize sensor ranges for all ships\nTwo-Team Commit Flow\nIn Creative Mode, both teams must commit before the turn resolves:\n\nIssue orders for Team A\nClick COMMIT → Auto-switches to Team B\nIssue orders for Team B\nClick COMMIT → Turn resolves\nNext turn starts with Team A\n\n\nBuilt-in Test Presets\nCreative Mode works with the preset system. Load these presets for targeted testing:\nCombat Systems\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPresetPurposeConfigurationRPS TriangleTest type advantages3v3: Interceptor, Gunship, Bomber each sideCombat Stress TestPerformance testing15x15 grid, 12+ ships per side\nCarrier Operations\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPresetPurposeConfigurationCarrier DuelLaunch/recover mechanics2 carriers per side with docked fightersEscort ProtectionEscort AI priorities3 civilian escorts with fighter protection\nFog of War\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPresetPurposeConfigurationFog of War TestSensor ranges, detection14x15 grid with scattered enemiesHazard GauntletNavigation, hazards13x14 grid with all hazard types\n\nManual E2E Testing Checklist\nUse Creative Mode for manual validation of game systems.\nRPS Combat Validation\n[ ] Load &quot;RPS Triangle&quot; preset\n[ ] Enable Creative Mode\n[ ] Move Interceptor to attack Bomber\n[ ] Verify Interceptor has advantage (higher damage)\n[ ] Move Bomber to attack Gunship\n[ ] Verify Bomber has advantage\n[ ] Move Gunship to attack Interceptor\n[ ] Verify Gunship has advantage\n\nCarrier Operations Validation\n[ ] Load &quot;Carrier Duel&quot; preset\n[ ] Enable Creative Mode\n[ ] Select carrier → verify LAUNCH mode available\n[ ] Issue LAUNCH command → fighter deploys from bay\n[ ] Move deployed fighter around grid\n[ ] Return fighter to carrier → verify LAND works\n[ ] Verify fighter returns to hangar bay\n\nFog of War Validation\n[ ] Load &quot;Fog of War Test&quot; preset\n[ ] Enable Creative Mode\n[ ] Toggle &quot;Detection Overlay&quot; on\n[ ] Verify Scout shows range 3 (larger circle)\n[ ] Verify Interceptors show range 1 (small circle)\n[ ] Verify Carrier shows range 2\n[ ] Move Scout toward hidden enemies\n[ ] Verify enemies reveal when in detection range\n[ ] Toggle &quot;Reveal Fog&quot; → all enemies visible\n\n\nDetection Ranges Reference\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nShip TypeDetection RangeNotesScout3Extended Sensors abilityFrigate2Fire Control NetworkDestroyer1Basic sensorsCarrier2Standard capitalInterceptor1Basic sensorsGunship1Basic sensorsBomber1Basic sensors\n\nCreating Custom Test Scenarios\n\nIn Fleet Setup, configure grid size and ships\nPosition ships for the scenario you want to test\nEnable Creative Mode\nClick Save to create a preset\nName it descriptively (e.g., “Dogfight - 2v2 Close Quarters”)\nPreset appears in your User Presets list\n\n\nKeyboard Shortcuts\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nKeyActionContextTabSwitch team controlDuring COMMIT phaseHomeRecenter gridAnytime\n\nFuture Enhancements\n\n Instant ship teleportation (debug)\n Damage/heal ships manually\n Spawn ships mid-battle\n Time controls (pause, step frame)\n Battle state save/load snapshots\n"},"developer-guide/index":{"slug":"developer-guide/index","filePath":"developer-guide/index.md","title":"Developer Guide","links":["developer-guide/architecture","developer-guide/screens","developer-guide/combat-system","developer-guide/save-system","developer-guide/testing"],"tags":[],"content":"Developer Guide\nWelcome to the Exodus Loop developer guide. This documentation covers the technical implementation, architecture patterns, and development workflows.\nQuick Start\n# Clone repository\ngit clone github.com/blamechris/exodus-loop.git\ncd exodus-loop\n \n# Open in Godot 4.5\ngodot project.godot\n \n# Run tests\ngodot --headless --script res://test/test_runner.gd\nSections\n\nArchitecture - Autoloads, signals, code patterns\nScreen Navigation - State machine and transition flow\nCombat Implementation - Phase breakdown, damage formulas\nSave System - Schema documentation, migration guide\nTesting Guide - Test patterns, coverage expectations\n\n\nProject Structure\nexodus-loop/\n├── src/\n│   ├── autoload/           # Singletons\n│   │   ├── game_state.gd   # Central state management\n│   │   ├── combat_resolver.gd\n│   │   ├── dice_system.gd\n│   │   └── save_manager.gd\n│   ├── entities/           # Game objects\n│   │   ├── squadron.gd\n│   │   ├── enemy.gd\n│   │   ├── carrier.gd\n│   │   ├── pilot.gd\n│   │   └── admiral.gd\n│   ├── screens/            # UI screens\n│   │   ├── battle/\n│   │   ├── title/\n│   │   ├── node_map/\n│   │   └── results/\n│   └── ui/components/      # Reusable UI\n├── test/                   # Test suite\n├── assets/                 # Sprites, audio\n├── docs/                   # Documentation\n└── .github/workflows/      # CI/CD\n\n\nKey Files\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFileLinesPurposegame_state.gd~2100Central state, upgrades, pilotscombat_resolver.gd~700Combat resolution logicbattle_screen.gd~2100Battle UI and phase managementsquadron.gd~800Squadron entitysave_manager.gd~400Persistence\n\nDevelopment Workflow\nTDD Modus Operandi\nAll development follows RED-GREEN-REFACTOR:\n\nRED: Write failing test first\nGREEN: Write minimal code to pass\nREFACTOR: Improve while keeping tests green\n\nBranch Naming\nfeat/feature-name     # New features\nfix/issue-description # Bug fixes\nrefactor/component    # Refactoring\ndocs/topic            # Documentation\ntest/test-description # Test additions\n\nCommit Messages\ntype(scope): Short summary in present tense\n\n[Optional body with details]\n\nTypes: feat, fix, refactor, docs, test, chore, style, perf\n\nCommon Pitfalls\nNull Safety\nMany locations lack null checks. Always verify before calling methods:\n# Bad\nsquadron.take_damage(5)\n \n# Good\nif squadron and is_instance_valid(squadron):\n    squadron.take_damage(5)\nID Management\nStatic ID counters (Squadron, Pilot) can have race conditions on save load:\n# After loading, sync counter to max loaded ID\nSquadron._next_id = loaded_squadrons.map(func(s): return s.id).max() + 1\nRNG Patterns\nUse instance RNG for reproducible results, function-scoped for procedural:\n# Instance RNG (reproducible with seed)\nvar rng = RandomNumberGenerator.new()\nrng.seed = seed_value\nvar result = rng.randi_range(1, 10)\n \n# Function-scoped (non-reproducible)\nvar result = randi_range(1, 10)\n\nMobile Considerations\n\nResolution: 720×1280 (9:16 portrait)\nTouch targets: Minimum 44px\nNo hover states: Touch-first design\nPerformance: Target 60fps on mid-range devices\n\n\nCI/CD Pipeline\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nJobRuns OnPurposeValidateAll PRsParse check, importTestAll PRsRun test suiteLintAll PRsGDScript lintingBuild Webmain onlyWeb exportBuild Androidmain onlyAPK export\nSee .github/workflows/ci.yml for details.\n\nGetting Help\n\nGitHub Issues\nCLAUDE.md in repository root\nThis documentation site\n"},"developer-guide/save-system":{"slug":"developer-guide/save-system","filePath":"developer-guide/save-system.md","title":"Save System","links":[],"tags":[],"content":"Save System\nExodus Loop uses JSON-based persistence with versioned schemas for forward compatibility.\nSave Types\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTypeFilePersistenceContentMetauser://meta_save.jsonPermanentXP, unlocks, admiral, blessedRunuser://run_save.jsonPer-runCurrent run state\n\nMeta Save Schema (v13)\n{\n  &quot;version&quot;: 13,\n  &quot;meta_xp&quot;: 1500,\n  &quot;unlocked_upgrades&quot;: [\n    &quot;reinforced_hull_1&quot;,\n    &quot;supply_cache_1&quot;,\n    &quot;sensors_1&quot;\n  ],\n  &quot;admiral&quot;: {\n    &quot;version&quot;: 2,\n    &quot;level&quot;: 3,\n    &quot;xp&quot;: 450,\n    &quot;unlocked_skills&quot;: [&quot;LAST_STAND&quot;, &quot;EJECT_PROTOCOL&quot;],\n    &quot;skill_tree_seed&quot;: 12345\n  },\n  &quot;blessed_squadrons&quot;: [...],\n  &quot;carried_over_pilots&quot;: [...],\n  &quot;hall_of_fame&quot;: [],\n  &quot;statistics&quot;: {...},\n  &quot;exodus_fleet&quot;: {\n    &quot;version&quot;: 1,\n    &quot;components&quot;: [\n      {\n        &quot;id&quot;: 1,\n        &quot;cell_type&quot;: 3,\n        &quot;shape_id&quot;: 5,\n        &quot;rarity&quot;: 2,\n        &quot;special_traits&quot;: [&quot;power_efficient&quot;],\n        &quot;damage_percent&quot;: 0.0,\n        &quot;source&quot;: &quot;extraction&quot;,\n        &quot;extraction_run&quot;: 5,\n        &quot;extraction_date&quot;: 1706300000,\n        &quot;is_equipped&quot;: false\n      }\n    ],\n    &quot;saved_carriers&quot;: [\n      {\n        &quot;id&quot;: 1,\n        &quot;name&quot;: &quot;Glass Cannon&quot;,\n        &quot;class_type&quot;: 2,\n        &quot;config&quot;: { /* ShipConfigurationV2 dict */ },\n        &quot;tags&quot;: [&quot;offensive&quot;, &quot;fast&quot;],\n        &quot;created_date&quot;: 1706200000,\n        &quot;last_used_date&quot;: 1706300000\n      }\n    ],\n    &quot;total_extracted&quot;: 15,\n    &quot;total_lost&quot;: 5\n  }\n}\nExodus Fleet Schema\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFieldTypeDescriptioncomponentsArrayExtracted components in fleetsaved_carriersArraySaved carrier build configurationstotal_extractedintLifetime components extractedtotal_lostintComponents lost to carrier destruction\nExtractedComponent Fields\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFieldTypeDescriptionidintUnique component IDcell_typeintShipGridData.CellType enumshape_idintPolyominoData.ShapeId enumrarityint0=Common, 1=Uncommon, 2=Rare, 3=Epic, 4=Legendaryspecial_traitsArrayTrait IDs for this componentdamage_percentfloat0.0-1.0, amount of damageis_equippedboolCurrently at risk in a run\n\nRun Save Schema (v9)\n{\n  &quot;version&quot;: 9,\n  &quot;seed&quot;: 987654,\n  &quot;turn_number&quot;: 12,\n  &quot;current_node_id&quot;: 5,\n  &quot;fleet_actions_remaining&quot;: 1,\n  &quot;resources&quot;: {\n    &quot;metal&quot;: 8,\n    &quot;energy&quot;: 12,\n    &quot;fuel&quot;: 2\n  },\n  &quot;carrier&quot;: {\n    &quot;hp&quot;: 7,\n    &quot;max_hp&quot;: 10,\n    &quot;grid_pos&quot;: [3, 7],\n    &quot;shield_available&quot;: true\n  },\n  &quot;squadron_roster&quot;: [\n    {\n      &quot;version&quot;: 7,\n      &quot;id&quot;: 1,\n      &quot;type&quot;: 0,\n      &quot;callsign&quot;: &quot;I-Alpha-1&quot;,\n      &quot;hull&quot;: 2,\n      &quot;max_hull&quot;: 3,\n      &quot;ammo&quot;: 1,\n      &quot;fuel&quot;: 3,\n      &quot;grid_pos&quot;: [2, 4],\n      &quot;state&quot;: &quot;READY&quot;,\n      &quot;ship_location&quot;: &quot;DOCKED&quot;,\n      &quot;assigned_pilot_id&quot;: 5,\n      &quot;is_enemy&quot;: false,\n      &quot;is_blessed&quot;: false\n    }\n  ],\n  &quot;pilot_roster&quot;: [\n    {\n      &quot;version&quot;: 3,\n      &quot;id&quot;: 5,\n      &quot;name&quot;: &quot;Maverick&quot;,\n      &quot;perks&quot;: [0, 2],\n      &quot;xp&quot;: 125,\n      &quot;level&quot;: 2,\n      &quot;morale&quot;: 65,\n      &quot;passive_ability&quot;: &quot;&quot;,\n      &quot;kills&quot;: 3,\n      &quot;missions&quot;: 2,\n      &quot;is_alive&quot;: true,\n      &quot;is_carried_over&quot;: false,\n      &quot;is_retired&quot;: false\n    }\n  ],\n  &quot;node_map&quot;: {\n    &quot;layers&quot;: 6,\n    &quot;nodes&quot;: [],\n    &quot;visited_nodes&quot;: [0, 1, 3, 5]\n  },\n  &quot;battle_state&quot;: null\n}\n\nVersion Migration\nFile: save_manager.gd:71-150\nfunc _migrate_meta_save(data: Dictionary) -&gt; Dictionary:\n    var version = data.get(&quot;version&quot;, 1)\n \n    # v1 -&gt; v2: Added admiral\n    if version &lt; 2:\n        data[&quot;admiral&quot;] = Admiral.new().to_dict()\n        version = 2\n \n    # v2 -&gt; v3: Added blessed_squadrons\n    if version &lt; 3:\n        data[&quot;blessed_squadrons&quot;] = []\n        version = 3\n \n    # v3 -&gt; v4: Added carried_over_pilots\n    if version &lt; 4:\n        data[&quot;carried_over_pilots&quot;] = []\n        version = 4\n \n    # v4 -&gt; v5: Added hall_of_fame\n    if version &lt; 5:\n        data[&quot;hall_of_fame&quot;] = []\n        version = 5\n \n    # v5 -&gt; v6: Added statistics\n    if version &lt; 6:\n        data[&quot;statistics&quot;] = _default_statistics()\n        version = 6\n \n    # v6 -&gt; v13: Added exodus_fleet (versions 7-12 were intermediate)\n    if version &lt; 13:\n        data[&quot;exodus_fleet&quot;] = {\n            &quot;version&quot;: 1,\n            &quot;components&quot;: [],\n            &quot;saved_carriers&quot;: [],\n            &quot;total_extracted&quot;: 0,\n            &quot;total_lost&quot;: 0\n        }\n        version = 13\n \n    data[&quot;version&quot;] = version\n    return data\nKnown Issue: Version Jumps\nLocation: save_manager.gd:71-150\nMigrations should be applied sequentially, but a v1→v6 jump may skip intermediate steps:\n# Problem: If version jumps from 1 to 6 directly,\n# intermediate migrations may be skipped\n \n# Fix: Ensure each migration only increments by 1\nwhile version &lt; CURRENT_VERSION:\n    data = _apply_migration(data, version)\n    version += 1\n\nSaveManager API\n# Meta state\nfunc save_meta_state() -&gt; void:\n    var data = {\n        &quot;version&quot;: META_VERSION,\n        &quot;meta_xp&quot;: GameState.meta_xp,\n        &quot;unlocked_upgrades&quot;: GameState.unlocked_upgrades,\n        &quot;admiral&quot;: GameState.current_admiral.to_dict(),\n        &quot;blessed_squadrons&quot;: _serialize_blessed(),\n        &quot;carried_over_pilots&quot;: _serialize_carried_pilots(),\n        &quot;hall_of_fame&quot;: _serialize_hall_of_fame(),\n        &quot;statistics&quot;: GameState.statistics\n    }\n    _write_json(&quot;user://meta_save.json&quot;, data)\n \nfunc load_meta_state() -&gt; bool:\n    var data = _read_json(&quot;user://meta_save.json&quot;)\n    if data.is_empty():\n        return false\n \n    data = _migrate_meta_save(data)\n    _apply_meta_state(data)\n    return true\n \n# Run state\nfunc save_run_state() -&gt; void:\n    var data = {\n        &quot;version&quot;: RUN_VERSION,\n        &quot;seed&quot;: GameState.current_seed,\n        &quot;turn_number&quot;: GameState.turn_number,\n        # ... full run state\n    }\n    _write_json(&quot;user://run_save.json&quot;, data)\n \nfunc load_run_state() -&gt; bool:\n    var data = _read_json(&quot;user://run_save.json&quot;)\n    if data.is_empty():\n        return false\n \n    data = _migrate_run_save(data)\n    _apply_run_state(data)\n    return true\n \nfunc has_saved_run() -&gt; bool:\n    return FileAccess.file_exists(&quot;user://run_save.json&quot;)\n \nfunc clear_run_save() -&gt; void:\n    DirAccess.remove_absolute(&quot;user://run_save.json&quot;)\n\nEntity Serialization\nSquadron.to_dict()\nfunc to_dict() -&gt; Dictionary:\n    return {\n        &quot;version&quot;: 7,\n        &quot;id&quot;: id,\n        &quot;type&quot;: type,\n        &quot;callsign&quot;: callsign,\n        &quot;hull&quot;: hull,\n        &quot;max_hull&quot;: max_hull,\n        &quot;ammo&quot;: ammo,\n        &quot;max_ammo&quot;: max_ammo,\n        &quot;fuel&quot;: fuel,\n        &quot;max_fuel&quot;: max_fuel,\n        &quot;grid_pos&quot;: [grid_pos.x, grid_pos.y],\n        &quot;state&quot;: State.keys()[state],\n        &quot;ship_location&quot;: ShipLocation.keys()[ship_location],\n        &quot;assigned_pilot_id&quot;: assigned_pilot_id,\n        &quot;is_enemy&quot;: is_enemy,\n        &quot;is_blessed&quot;: is_blessed\n    }\n \nstatic func from_dict(data: Dictionary) -&gt; Squadron:\n    var squad = Squadron.new()\n    squad.id = data.id\n    squad.type = data.type\n    squad.callsign = data.callsign\n    # ... restore all fields\n    return squad\nPilot.to_dict()\nfunc to_dict() -&gt; Dictionary:\n    return {\n        &quot;version&quot;: 3,\n        &quot;id&quot;: id,\n        &quot;name&quot;: name,\n        &quot;perks&quot;: perks.map(func(p): return int(p)),\n        &quot;xp&quot;: xp,\n        &quot;level&quot;: level,\n        &quot;morale&quot;: morale,\n        &quot;passive_ability&quot;: passive_ability,\n        &quot;kills&quot;: kills,\n        &quot;missions&quot;: missions,\n        &quot;is_alive&quot;: is_alive,\n        &quot;is_carried_over&quot;: is_carried_over,\n        &quot;is_retired&quot;: is_retired\n    }\n\nID Synchronization\nAfter loading, sync static ID counters to prevent collisions:\nfunc _sync_id_counters() -&gt; void:\n    # Squadron IDs\n    var max_squad_id = 0\n    for squad in GameState.squadron_roster + GameState.blessed_squadrons:\n        max_squad_id = maxi(max_squad_id, squad.id)\n    Squadron._next_id = max_squad_id + 1\n \n    # Pilot IDs\n    var max_pilot_id = 0\n    for pilot in GameState.pilot_roster + GameState.carried_over_pilots:\n        max_pilot_id = maxi(max_pilot_id, pilot.id)\n    Pilot._next_id = max_pilot_id + 1\n\nTesting Saves\n# Test save/load cycle\nfunc test_save_load_integrity():\n    var original_state = GameState.snapshot()\n    SaveManager.save_run_state()\n \n    GameState.reset()\n    SaveManager.load_run_state()\n \n    var loaded_state = GameState.snapshot()\n    assert(original_state == loaded_state, &quot;Save/load integrity failed&quot;)"},"developer-guide/screens":{"slug":"developer-guide/screens","filePath":"developer-guide/screens.md","title":"Screen Navigation","links":[],"tags":[],"content":"Screen Navigation\nExodus Loop uses a state-machine approach to screen management, with main.gd as the central coordinator.\nScreen State Machine\nstateDiagram-v2\n    [*] --&gt; Title\n    Title --&gt; FleetSetup: New Game\n    Title --&gt; NodeMap: Continue\n    Title --&gt; Upgrades: Meta Upgrades\n    Title --&gt; Achievements: Achievements\n    Title --&gt; Settings: Settings\n\n    FleetSetup --&gt; NodeMap: Start Run\n\n    NodeMap --&gt; Battle: Enter Node\n    NodeMap --&gt; Upgrades: View Upgrades\n\n    Battle --&gt; Results: Battle End\n    Battle --&gt; NodeMap: Escape\n\n    Results --&gt; NodeMap: Continue\n    Results --&gt; BlessedSelection: Run End (victory)\n    Results --&gt; Title: Run End (death)\n\n    BlessedSelection --&gt; Title: Selection Complete\n\n    Upgrades --&gt; Title: Back (from title)\n    Upgrades --&gt; NodeMap: Back (from map)\n\n    Achievements --&gt; Title: Back\n    Settings --&gt; Title: Back\n\n\nScreen Registry\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nScreenFilePurposeTitlescreens/title/title_screen.tscnMain menuFleetSetupscreens/fleet_setup/fleet_setup_screen.tscnCarrier selection and run configurationNodeMapscreens/node_map/node_map_screen.tscnRun navigationBattlescreens/battle/battle_screen.tscnCombat (includes Preparation phase)Resultsscreens/results/results_screen.tscnPost-battleUpgradesscreens/upgrades/upgrades_screen.tscnMeta-progressionAchievementsscreens/achievements/achievements_screen.tscnView unlocked achievementsBlessedSelectionscreens/blessed_selection/blessed_selection_screen.tscnBless squadronsSettingsscreens/settings/settings_screen.tscnOptionsLoadoutSelectionscreens/loadout/loadout_selection_screen.tscnChoose starting squadrons\n\nTransition Flow\nmain.gd Coordination\n# Screen references\nvar current_screen: Control = null\nvar screens: Dictionary = {}\n \nfunc _ready() -&gt; void:\n    # Load all screens\n    screens[&quot;title&quot;] = preload(&quot;res://src/screens/title/title_screen.tscn&quot;)\n    screens[&quot;battle&quot;] = preload(&quot;res://src/screens/battle/battle_screen.tscn&quot;)\n    # ... etc\n \n    _show_screen(&quot;title&quot;)\n \nfunc _on_screen_change_requested(name: String, params: Dictionary = {}) -&gt; void:\n    _transition_to_screen(name, params)\n \nfunc _transition_to_screen(name: String, params: Dictionary) -&gt; void:\n    if current_screen:\n        current_screen.queue_free()\n \n    var screen_scene = screens[name]\n    current_screen = screen_scene.instantiate()\n \n    # Connect signals\n    if current_screen.has_signal(&quot;screen_change_requested&quot;):\n        current_screen.screen_change_requested.connect(_on_screen_change_requested)\n \n    # Pass params\n    if current_screen.has_method(&quot;setup&quot;):\n        current_screen.setup(params)\n \n    add_child(current_screen)\nScreen Base Pattern\nextends Control\n \nsignal screen_change_requested(screen_name: String, params: Dictionary)\n \nfunc setup(params: Dictionary) -&gt; void:\n    # Initialize from params\n    pass\n \nfunc _on_back_pressed() -&gt; void:\n    screen_change_requested.emit(&quot;previous_screen&quot;, {})\n\nBattle Screen State Machine\nThe battle screen itself has complex internal states:\nstateDiagram-v2\n    [*] --&gt; PREPARATION\n    PREPARATION --&gt; INTEL: Commit deployment\n\n    INTEL --&gt; COMMAND: Tap to continue\n\n    COMMAND --&gt; RESOLUTION: End Turn\n    COMMAND --&gt; COMMAND: Assign actions\n\n    RESOLUTION --&gt; UPKEEP: All combat resolved\n\n    UPKEEP --&gt; INTEL: Continue\n    UPKEEP --&gt; VICTORY: Win condition met\n    UPKEEP --&gt; DEFEAT: Carrier destroyed\n\n    VICTORY --&gt; [*]\n    DEFEAT --&gt; [*]\n\nBattle Phases\nenum TurnPhase {\n    PREPARATION, # Initial carrier/squadron placement\n    INTEL,       # Read-only, view enemy positions\n    COMMAND,     # Player assigns actions\n    RESOLUTION,  # Execute all actions\n    UPKEEP,      # Reset state for next turn\n    VICTORY,     # Battle won\n    DEFEAT       # Battle lost\n}\n \nvar current_phase: TurnPhase = TurnPhase.PREPARATION\nPreparation Phase Details:\n\nConfigurable deployment zone (default: bottom 3 rows)\nCampaign battles use 11×13 grid\nTap ship → SelectedShipCard with animated boot sequence\nHolographic selection line connects ship to info card\nFleet roster panels show all ships (player left, enemy right)\nShips with “Early Launch” trait can deploy from carrier\nDrag ships to reposition within deployment zone\n“Done” button transitions to INTEL phase\n\nPhase Transitions\nfunc _advance_phase() -&gt; void:\n    match current_phase:\n        BattlePhase.INTEL:\n            current_phase = BattlePhase.COMMAND\n            _enter_command_phase()\n \n        BattlePhase.COMMAND:\n            current_phase = BattlePhase.RESOLUTION\n            await _execute_resolution()\n            current_phase = BattlePhase.UPKEEP\n            _process_upkeep()\n \n        BattlePhase.UPKEEP:\n            if _check_victory():\n                current_phase = BattlePhase.VICTORY\n            elif _check_defeat():\n                current_phase = BattlePhase.DEFEAT\n            else:\n                current_phase = BattlePhase.INTEL\n                _enter_intel_phase()\n\nKnown Issues\nRace Condition in Transitions\nLocation: main.gd:84-90\nDouble-clicking can trigger multiple transitions:\n# Problem: pending_destination can be overwritten\nfunc _on_screen_change_requested(name: String, params: Dictionary) -&gt; void:\n    pending_destination = name  # Can be overwritten by second click\n    _transition_to_screen(name, params)\nMitigation: Add transition lock:\nvar is_transitioning: bool = false\n \nfunc _on_screen_change_requested(name: String, params: Dictionary) -&gt; void:\n    if is_transitioning:\n        return\n    is_transitioning = true\n    await _transition_to_screen(name, params)\n    is_transitioning = false\nModal Cleanup\nLocation: battle_screen.gd:266-276\nModals may not be properly cleaned up on screen exit:\n# Should be called in _exit_tree\nfunc _cleanup_modals() -&gt; void:\n    for modal in active_modals:\n        if is_instance_valid(modal):\n            modal.queue_free()\n    active_modals.clear()\n\nNavigation Examples\nStarting New Run\n# From Title Screen\nfunc _on_new_game_pressed() -&gt; void:\n    GameState.start_new_run()\n    screen_change_requested.emit(&quot;node_map&quot;, {})\nEntering Battle\n# From Node Map\nfunc _on_node_selected(node_id: int) -&gt; void:\n    var node_data = GameState.get_node_data(node_id)\n    screen_change_requested.emit(&quot;battle&quot;, {\n        &quot;node_id&quot;: node_id,\n        &quot;node_type&quot;: node_data.type\n    })\nPost-Battle Flow\n# From Battle Screen\nfunc _on_battle_ended(victory: bool) -&gt; void:\n    screen_change_requested.emit(&quot;results&quot;, {\n        &quot;victory&quot;: victory,\n        &quot;stats&quot;: _collect_battle_stats()\n    })\n \n# From Results Screen\nfunc _on_continue_pressed() -&gt; void:\n    if _is_run_complete():\n        if victory:\n            screen_change_requested.emit(&quot;blessed_selection&quot;, {})\n        else:\n            screen_change_requested.emit(&quot;title&quot;, {})\n    else:\n        screen_change_requested.emit(&quot;node_map&quot;, {})"},"developer-guide/testing":{"slug":"developer-guide/testing","filePath":"developer-guide/testing.md","title":"Testing Guide","links":[],"tags":[],"content":"Testing Guide\nExodus Loop follows Test-Driven Development (TDD) with a custom test runner.\nRunning Tests\n# Run all tests\ngodot --headless --script res://test/test_runner.gd\n \n# Run specific test file\ngodot --headless --script res://test/test_runner.gd -- --filter=combat\n \n# Verbose output\ngodot --headless --script res://test/test_runner.gd -- --verbose\n\nTest Structure\ntest/\n├── test_runner.gd      # Main test runner with assertions\n├── test_runner.tscn    # Scene for running tests\n├── unit/               # Unit tests\n│   ├── test_squadron.gd\n│   ├── test_pilot.gd\n│   ├── test_combat_resolver.gd\n│   └── test_dice_system.gd\n├── integration/        # Integration tests\n│   └── test_battle_flow.gd\n└── fixtures/           # Test data\n    └── test_scenarios.gd\n\n\nTest Runner API\nextends Node\n \n# Assertions\nfunc assert_true(condition: bool, message: String = &quot;&quot;) -&gt; void\nfunc assert_false(condition: bool, message: String = &quot;&quot;) -&gt; void\nfunc assert_eq(actual, expected, message: String = &quot;&quot;) -&gt; void\nfunc assert_ne(actual, expected, message: String = &quot;&quot;) -&gt; void\nfunc assert_lt(actual, expected, message: String = &quot;&quot;) -&gt; void\nfunc assert_gt(actual, expected, message: String = &quot;&quot;) -&gt; void\nfunc assert_null(value, message: String = &quot;&quot;) -&gt; void\nfunc assert_not_null(value, message: String = &quot;&quot;) -&gt; void\nfunc assert_in_range(value, min_val, max_val, message: String = &quot;&quot;) -&gt; void\n \n# Test lifecycle\nfunc before_all() -&gt; void    # Run once before all tests\nfunc after_all() -&gt; void     # Run once after all tests\nfunc before_each() -&gt; void   # Run before each test\nfunc after_each() -&gt; void    # Run after each test\n\nWriting Tests\nBasic Test Pattern\n# test/unit/test_squadron.gd\nextends &quot;res://test/test_runner.gd&quot;\n \nfunc test_squadron_creation():\n    var squad = Squadron.new()\n    squad.initialize(Squadron.SquadronType.INTERCEPTOR, Vector2i(2, 3))\n \n    assert_eq(squad.type, Squadron.SquadronType.INTERCEPTOR)\n    assert_eq(squad.grid_pos, Vector2i(2, 3))\n    assert_eq(squad.hull, 3, &quot;Interceptor should have 3 hull&quot;)\n \nfunc test_squadron_takes_damage():\n    var squad = Squadron.new()\n    squad.initialize(Squadron.SquadronType.GUNSHIP, Vector2i.ZERO)\n \n    var initial_hull = squad.hull\n    squad.take_damage(2)\n \n    assert_eq(squad.hull, initial_hull - 2)\n \nfunc test_squadron_destroyed_at_zero_hull():\n    var squad = Squadron.new()\n    squad.initialize(Squadron.SquadronType.SCOUT, Vector2i.ZERO)\n \n    squad.take_damage(squad.hull)\n \n    assert_eq(squad.hull, 0)\n    assert_true(squad.is_destroyed())\nTesting Combat\n# test/unit/test_combat_resolver.gd\nextends &quot;res://test/test_runner.gd&quot;\n \nfunc before_each():\n    GameState.reset()\n    GameState.grid_width = 7\n    GameState.grid_height = 8\n \nfunc test_rps_advantage_interceptor_vs_bomber():\n    var interceptor = _create_squadron(Squadron.SquadronType.INTERCEPTOR, Vector2i(3, 3))\n    var bomber = _create_enemy(Squadron.SquadronType.BOMBER, Vector2i(3, 3))\n \n    var die_type = DiceSystem.get_rps_die(interceptor.type, bomber.squadron.type)\n \n    assert_eq(die_type, DiceSystem.DiceType.D10, &quot;Interceptor should have d10 vs Bomber&quot;)\n \nfunc test_combat_resolution_sequential():\n    var attacker = _create_squadron(Squadron.SquadronType.INTERCEPTOR, Vector2i(3, 3))\n    var defender = _create_enemy(Squadron.SquadronType.BOMBER, Vector2i(3, 3))\n \n    var log = CombatResolver.resolve_cell_combat(Vector2i(3, 3))\n \n    assert_not_null(log)\n    assert_eq(log.cell_pos, Vector2i(3, 3))\n    assert_gt(log.initiative_order.size(), 0)\n \nfunc _create_squadron(type: int, pos: Vector2i) -&gt; Squadron:\n    var squad = Squadron.new()\n    squad.initialize(type, pos)\n    GameState.squadron_roster.append(squad)\n    return squad\n \nfunc _create_enemy(type: int, pos: Vector2i) -&gt; Enemy:\n    var enemy = Enemy.new()\n    enemy.initialize(type, pos)\n    GameState.enemy_roster.append(enemy)\n    return enemy\nTesting Dice System\n# test/unit/test_dice_system.gd\nextends &quot;res://test/test_runner.gd&quot;\n \nfunc test_initiative_roll_range():\n    for spd in range(1, 5):\n        for _i in range(100):\n            var roll = DiceSystem.roll_initiative(spd)\n            assert_in_range(roll.base_roll, 1, spd + 1,\n                &quot;Initiative roll should be 1 to SPD+1&quot;)\n \nfunc test_damage_formula():\n    # Damage = max(0, roll + atk - def)\n    var roll = DiceSystem.roll_damage(3, 2, DiceSystem.DiceType.D6)\n \n    # Roll is 1-6, atk=3, def=2\n    # Damage = roll + 3 - 2 = roll + 1\n    # Range: 2-7\n    assert_in_range(roll.total, 0, 10)\n \nfunc test_rps_die_types():\n    # Interceptor vs Bomber = advantage = d10\n    assert_eq(\n        DiceSystem.get_rps_die(Squadron.SquadronType.INTERCEPTOR, Squadron.SquadronType.BOMBER),\n        DiceSystem.DiceType.D10\n    )\n \n    # Bomber vs Interceptor = disadvantage = d4\n    assert_eq(\n        DiceSystem.get_rps_die(Squadron.SquadronType.BOMBER, Squadron.SquadronType.INTERCEPTOR),\n        DiceSystem.DiceType.D4\n    )\n \n    # Frigate vs anything = neutral = d6\n    assert_eq(\n        DiceSystem.get_rps_die(Squadron.SquadronType.FRIGATE, Squadron.SquadronType.BOMBER),\n        DiceSystem.DiceType.D6\n    )\n\nTDD Workflow\nRED Phase\nWrite a failing test first:\nfunc test_pilot_gains_xp_on_kill():\n    var pilot = Pilot.new()\n    pilot.initialize(&quot;Maverick&quot;)\n    var initial_xp = pilot.xp\n \n    pilot.award_kill_xp()  # Method doesn&#039;t exist yet\n \n    assert_eq(pilot.xp, initial_xp + 10, &quot;Kill should award 10 XP&quot;)\nGREEN Phase\nWrite minimal code to pass:\n# In pilot.gd\nfunc award_kill_xp() -&gt; void:\n    xp += 10\nREFACTOR Phase\nImprove while keeping tests green:\n# In pilot.gd\nconst KILL_XP = 10\n \nfunc award_kill_xp() -&gt; void:\n    add_xp(KILL_XP)\n \nfunc add_xp(amount: int) -&gt; void:\n    xp += amount\n    _check_level_up()\n\nCoverage Targets\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLayerTargetCore game logic&gt;80%UI components&gt;60%Utilities&gt;90%Overall minimum80%\n\nCI Integration\nTests run automatically on all PRs:\n# .github/workflows/ci.yml\ntest:\n  runs-on: ubuntu-latest\n  steps:\n    - uses: actions/checkout@v4\n    - name: Setup Godot\n      uses: chickensoft-games/setup-godot@v2\n      with:\n        version: 4.5\n    - name: Run tests\n      run: godot --headless --script res://test/test_runner.gd\n\nTesting Best Practices\n\nTest behavior, not implementation - Focus on what the code does, not how\nOne assertion per concept - Multiple asserts OK if testing same thing\nDescriptive test names - test_pilot_level_up_at_50_xp not test_pilot_1\nIsolate tests - Use before_each to reset state\nTest edge cases - Zero, negative, max values\nMock external dependencies - Don’t depend on file system in unit tests\n"},"game-design/achievements":{"slug":"game-design/achievements","filePath":"game-design/achievements.md","title":"Achievements","links":[],"tags":[],"content":"Achievements\nExodus Loop features 6 unlockable achievements that track player milestones across runs.\nAchievement List\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAchievementDescriptionUnlock ConditionFirst BloodDestroy your first enemy squadronDestroy any enemy in combatSector ClearComplete your first sectorFinish sector 1+Fleet AdmiralDefeat the final boss and win a runComplete a full run victoryAce PilotHave a pilot reach Legend rankLevel a pilot to rank 5Flawless VictoryWin a battle without losing any squadronsComplete battle with zero squadron deathsAgainst All OddsWin a run with only 1 squadron remainingComplete a run while down to last squadron\n\nAchievement System Details\nUnlock Timing\n\nAchievements are checked at appropriate game moments:\n\nFirst Blood: End of combat resolution when enemy destroyed\nSector Clear: On sector completion\nFleet Admiral: On run victory\nAce Pilot: When pilot levels up to rank 5\nFlawless Victory: End of battle with victory and zero deaths\nAgainst All Odds: Run victory with single remaining squadron\n\n\n\nPersistence\n\nUnlock timestamps are stored in meta state\nUnlocked achievements persist permanently across all runs\nAchievements are saved immediately upon unlock via SaveManager.save_meta_state()\n\nViewing Achievements\n\nAccessible from the title screen via Achievements button\nShows locked and unlocked status\nDisplays unlock timestamp for completed achievements\n\n\nDesign Notes\nProgressive Difficulty:\n\nFirst Blood → Sector Clear → Fleet Admiral forms a natural progression\nAce Pilot and Flawless Victory reward mastery of specific systems\nAgainst All Odds is the ultimate challenge achievement\n\nNo Rewards:\n\nAchievements are currently for prestige only\nNo gameplay unlocks tied to achievements (by design)\n"},"game-design/balance":{"slug":"game-design/balance","filePath":"game-design/balance.md","title":"Balance Constants","links":["internal/tech-debt"],"tags":[],"content":"Balance Constants\nThis page documents all magic numbers extracted from the codebase, providing a single reference for balance tuning.\nSquadron Base Stats\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTypeSPDATKDEFHullAmmoFuelMoveDetectionInterceptor31133421Bomber13142211Gunship22353311Frigate21245412Destroyer23153311Scout41122523Miner10130411\nFile: src/entities/squadron.gd lines 15-51\n\nResource Costs\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSquadronMetalEnergyInterceptor20Bomber02Gunship11Frigate21Destroyer21Scout11MinerTBDTBD\n\nStarting Resources\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nResourceBaseWith UpgradesMetal1013 (supply_cache_1)Energy1013 (supply_cache_1)Fuel34 (fuel_reserves_1)Hangar35 (expanded_hangar_1)\nFile: src/autoload/game_state.gd lines 366-394\n\nCarrier Stats\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nStatBase ValueWith UpgradesHP1020 (reinforced_hull_1 + _2)Detection Range23 (long_range_sensors)Point DefenseHP ≤ 2HP ≤ 4 (point_defense_plus_1)Shield Burst—3 damage (shield_burst_1)\n\nCombat Constants\nDamage Formula\nDamage = max(0, DiceRoll + ATK - DEF)\n\nDice Types\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTypeRangeAveraged4 (disadvantage)1-42.5d6 (neutral)1-63.5d10 (advantage)1-105.5\nInitiative Formula\nInitiative = 1d[SPD+1]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSPDDie SizeRangeAverage1d21-21.52d31-32.03d41-42.54d51-53.0\nFile: src/autoload/dice_system.gd lines 52-112\n\nAction Modifiers\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nActionATKDEFATTACK+10DEFEND+1+2MOVE00LAND00\nFile: src/entities/squadron.gd lines 438-546\n\nMorale Thresholds\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRangeATK ModDEF ModHigh (≥80)+10Normal (21-79)00Low (≤20)-1-1\nMorale Changes\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nEventChangeVictory+10Kill+5Damage taken-5 per HPAlly destroyed-15Escort destroyed-10\nFile: src/autoload/game_state.gd lines 1928-2003\n\nPilot XP Thresholds\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLevelXP RequiredCumulative10025050315015043003005500500\nXP Awards\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nEventXPMission survival25Boss mission50Enemy kill10Run completion25\nFile: src/entities/pilot.gd\n\nAdmiral XP Thresholds\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLevelXP for NextCumulative0→11001001→22503502→34508003→470015004→5100025005→615004000\nFile: src/entities/admiral.gd\n\nMeta-Upgrade Costs\nBy Tier\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTierCost RangeCount150 XP5275-100 XP103100-150 XP44150-200 XP3\nTotal XP to Unlock All\n\nMinimum path: ~1500 XP\nAll upgrades: ~2000 XP\n\nFile: src/autoload/game_state.gd lines 94-254\n\nBattle Generation\nDefault Grid Size\n\nWidth: 7 cells\nHeight: 8 cells\nMinimum safe: 6×7 (WARNING: smaller maps break spawn zone calculations)\n\nSpawn Zones\n\nPlayer: Bottom 2 rows\nEnemy: Top 2 rows\nCarrier: Center-bottom\n\nFile: src/autoload/battle_map_generator.gd lines 150-196\n\nAdmiral Skill Values\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSkillStatValueLAST_STANDatk_bonus_low_hp+1EMERGENCY_REPAIRScarrier_heal_end+1 HPEJECT_PROTOCOLpilot_survival_chance0.20RALLY_CRYfirst_squadron_ap+1 APIRON_WILLcarrier_first_hit_reduction-1 dmgDESPERATE_MEASURESatk_bonus_carrier_critical+2\nFile: src/entities/admiral.gd lines 13-86\n\nKnown Balance Issues\nSee Tech Debt for:\n\nPilot survival chance can exceed 1.0 (unclamped)\nMinimum map size unvalidated\nVarious magic number locations needing constants\n\n\nAll values extracted from codebase v0.5.23"},"game-design/carriers":{"slug":"game-design/carriers","filePath":"game-design/carriers.md","title":"Carrier Types","links":[],"tags":[],"content":"Carrier Types\nThe carrier is your mobile base and flagship. You select your carrier class at the start of each run, which determines your starting components and bonuses.\nCarrier Classes (4)\nEach carrier class provides a different starting configuration in the Ship Builder V2 polyomino system.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nClassNameSpeedDetectionDefenseAttackHangarSpecialtySCOUTScout Carrier+1+2——SmallSensors, speedSTANDARDStandard Carrier————MediumBalancedBATTLEBattlecarrier——+2+1MediumArmor, weaponsTENDERFleet Tender————+2Large hangars\nScout Carrier\nFast and agile with extended sensors.\n\nGuaranteed pieces: Hull Core, Reactor, Engine (large), Sensor Array, Hangar (small), Bridge\nBonus draw pool: 60% Sensors, 40% Engines, 20% Armor\nBest for: Hit-and-run tactics, early detection, reconnaissance\n\nStandard Carrier\nBalanced performance for all situations.\n\nGuaranteed pieces: Hull Core, Reactor, Engine, Hangar ×2, Bridge, Armor\nBonus draw pool: Even mix of Hangars, Armor, Engines, Weapons\nBest for: Learning the game, adaptable strategies\n\nBattlecarrier\nHeavy armor and firepower at the cost of mobility.\n\nGuaranteed pieces: Hull Core, Large Reactor, Engine (small), Weapon Bays ×2, Heavy Armor ×2, Hangar, Bridge\nBonus draw pool: 50% Armor, 33% Weapons, 17% Reactors\nBest for: Defensive playstyles, holding positions, tanking damage\n\nFleet Tender\nLarge hangar capacity for maximum squadron deployment.\n\nGuaranteed pieces: Hull Core, Reactors ×2, Engine, Large Hangars ×3, Bridge, Crew Quarters\nBonus draw pool: 50% Hangars, 33% Crew Quarters, 17% Engineering\nBest for: Squadron-focused strategies, swarm tactics\n\n\nShip Builder V2 (Polyomino System)\nCarriers are built using a tetris-style polyomino system. Each component is a shaped piece that must fit on the carrier’s grid.\nComponent Types\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTypeIconFunctionPowerHULL_CORE[C]Mandatory center, destruction = explosion—ARMOR[#]Absorbs damage, protects other components0REACTOR[R]Generates power for other systems+powerENGINE[E]Provides movement speed-powerHANGAR[H]Stores and launches squadrons-powerWEAPON_BAY[W]Offensive weapons-powerSENSOR_ARRAY[S]Detection and targeting-powerBRIDGE[B]Command and control-powerCREW_QUARTERS[Q]Crew capacity-powerENGINEERING[G]Repair and maintenance-power\nPolyomino Shapes\nComponents come in various shapes:\n\nSingle (1 cell)\nDomino (2 cells: horizontal or vertical)\nTromino (3 cells: I, L shapes)\nTetromino (4 cells: O, I, T, L, S shapes)\n\nLarger shapes provide more stats per piece but are harder to fit.\nSectors\nThe carrier grid is divided into 5 sectors for directional damage:\n        FRONT\n    +----------+\n    |    F     |\n L  | L  C  R  |  R\n E  |    O     |  I\n F  |    R     |  G\n T  |    E     |  H\n    |          |  T\n    +----------+\n        REAR\n\n\nCENTER: Hull Core (mandatory 2×2)\nFRONT: Sensors, forward weapons\nREAR: Engines, reactors\nLEFT/RIGHT: Hangars, side weapons\n\n\nDirectional Damage System\nDamage comes from a direction based on attacker position relative to defender heading.\nDamage Flow\n\nIncoming damage hits the sector facing the attacker\nOuter components in that sector take damage first\nDamage progresses inward toward Hull Core\n\nSector Damage States\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nConditionEffect50% sector cells damagedSECTOR CRITICAL - systems in that sector disabled50%+ total tiles damagedCRITICALLY DAMAGED - can’t move/actHull Core destroyed OR 75%+ destroyedEXPLOSION - carrier destroyed\nDisabled Sector Effects\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSectorSystems LostFRONTSensors, forward weaponsREAREngines (can’t move), reactors offlineLEFTLeft hangar bays, left weaponsRIGHTRight hangar bays, right weaponsCENTEREXPLOSION (core is center)\n\nCapital Ship Collisions\nWhen two capital ships attempt to occupy the same cell:\n\nBoth take collision damage: 2 + size difference\nSmaller ship takes +1 extra damage\nBoth pushed back 1 tile in opposite directions\nEdge collision: +2 damage instead of pushback\n\n\nEnemy Carriers\nEnemy carriers use the same polyomino system but with procedurally generated loadouts.\nBase Stats: ATK 1, DEF 2, SPD 1, Hull 10, Hangar 4\nBehavior Traits:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTraitEffectAGGRESSIVE-50% retreat chance, +20% attack priorityDEFENSIVE+30% hold-near-carrier behaviorHUNTERFocuses exclusively on player carrierCAUTIOUS+40% retreat chanceSTATIC80% hold position, 20% advanceSUICIDAL0% retreat, +1 ATK\nNautolan Leviathan\nA special enemy carrier variant for the Nautolan alien faction with bio-organic components and swarm tactics."},"game-design/combat":{"slug":"game-design/combat","filePath":"game-design/combat.md","title":"Combat System","links":["internal/reinforcements","game-design/carriers"],"tags":[],"content":"Combat System\nExodus Loop uses a Puzzle Pirates-inspired intent-based combat system with simultaneous resolution. Players queue 3 movement intents per ship, then all ships execute in speed order across 3 sub-phases.\nCombat Phases\nEach battle begins with a Positioning Phase, followed by repeating combat turns:\ngraph LR\n    POSITIONING --&gt; COMMIT --&gt; RESOLVE --&gt; UPKEEP\n    UPKEEP --&gt; COMMIT\n\n\nPositioning Phase\nBefore combat begins, position your forces:\nDeployment Zone:\n\nConfigurable per battle (default: 3 rows at bottom for player)\nGrid size: 11×13 cells for campaign battles\nZone highlighted with green tint\n\nShip Selection:\n\nTap any ship on grid → Info card appears with stats\nTap ship in Fleet Roster panel → Same info card\nHolographic connection line links ship to card\nTap empty cell to dismiss selection\n\nCarrier Placement:\n\nDrag carrier within deployment zone to reposition\nMulti-tile ships validated to stay within grid\n\nFighter Deployment:\n\nShips with “Early Launch” trait can deploy from carrier during positioning\nTap docked ship with trait → Launch modal appears\nRemaining fighters stay in hangar for mid-battle launches\n\nControls:\n\nTap ship to select and view info card\nDrag ship to reposition within deployment zone\n“Done” button transitions to COMMIT phase\n\n\nCommit Phase\nDuring COMMIT, set orders for all your ships:\n3-Action Queue\nEach ship has a 3-slot action queue for movement intents:\n┌─────────────────── ACTION QUEUE ───────────────────┐\n│  [SLOT 1]      [SLOT 2]      [SLOT 3]             │\n│  FORWARD       TURN LEFT     FORWARD              │\n│  🔥 FIRE       ○ HOLD        🔥 FIRE              │\n└────────────────────────────────────────────────────┘\n\nMovement Intents:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIntentEffectFORWARDMove 1 cell in facing directionTURN_LEFTRotate 90° left + move diagonallyTURN_RIGHTRotate 90° right + move diagonallyHOLDStay in place, no actionLANDReturn to carrier (must be adjacent)\nFire Toggles:\n\nEach slot has an independent fire toggle\nEnabled = ship attempts to fire after moving in that sub-phase\nTargets are auto-selected based on weapon arc and range\n\nDynamic Movement Slots\nShips have different movement capacities based on size:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nShip SizeBase SlotsBlocked PhasesSMALL (fighters)3NoneMEDIUM (frigates)21 blockedLARGE (carriers)12 blocked\nBlocked Phases: Ships with fewer slots have “blocker” tokens that mark phases where they cannot move. Blockers can be dragged to different slots.\nEngine Damage: Damaged engines reduce available slots:\n\nEngine health &gt; 33%: No penalty\nEngine health 1-33%: -1 slot\nEngine health 0%: -2 slots\n\nCarrier Launch System\nCarriers use per-phase launch toggles instead of movement intents:\n┌─────────────────── CARRIER ACTIONS ────────────────┐\n│  [SLOT 1]      [SLOT 2]      [SLOT 3]             │\n│  FORWARD       HOLD          HOLD                 │\n│  🔥 FIRE       ○ HOLD        ○ HOLD               │\n│  [LNCH: Port]  [LNCH: ---]   [LNCH: Stbd]        │\n└────────────────────────────────────────────────────┘\n\nLNCH Toggles:\n\nEach phase has independent launch toggles per bay\nClick LNCH to cycle: --- → Port Bay → Starboard Bay → ---\nMultiple ships can launch in the same phase (one per bay)\nLaunches happen BEFORE movement in each sub-phase\n\nDocked Ship Pre-Orders\nSet orders for docked ships before they launch:\n\nClick ”☰ FLEET” button to open Fleet Roster during COMMIT\nSelect a docked ship from the roster\nSet movement intents and fire toggles as “pre-orders”\nOrders only execute when ship actually launches\n\nPre-Order Rules:\n\nIf carrier doesn’t launch the ship, pre-orders are ignored\nUseful for coordinated fleet maneuvers\nLaunched ships can move in the same phase they launch\n\nAction Bars\nShips display a visual indicator of queued actions:\n[███|░░░|░░░]  = 1 action queued\n[███|███|░░░]  = 2 actions queued\n[███|███|███]  = 3 actions queued\n\nSegments fill based on: non-HOLD movements + enabled fires + launch orders.\n\nSingle-Occupancy Tactical Mode\n\nDefault as of v0.5.30 - This is now the standard combat mode.\n\nThe combat system uses single-occupancy rules, meaning:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRuleEffectOne ship per cellOccupied cells block movement - ships stay in placeNo MBM modalDogfights resolve in tactical layer, not popupAmmo on missAmmo consumed even when firing at empty spaceWeapon cooldownsWeapons have cooldown turns between usesAdjacent dogfightsShips attack enemies in adjacent cells\nCell Occupancy\n\nWhen a ship attempts to move into an occupied cell, it stays in place\nFacing is preserved (no rotation penalty)\nPlan moves carefully to avoid traffic jams\n\nTactical Dogfights\nInstead of modal-based combat when ships share a cell:\n\nShips fire at adjacent enemies during the fire sub-phase\nDamage is applied immediately in the tactical layer\nNo separate dogfight popup\n\nWeapon Cooldowns\nSome weapons have cooldown periods:\nIon Cannon: 2-turn cooldown\nStandard Laser: No cooldown (fires every turn)\n\n\nResolve Phase\nAll ships execute their queued actions simultaneously across 3 sub-phases.\nSub-Phase Resolution Order\nFor each sub-phase (1, 2, 3):\n\nLaunches - Carriers launch ships from enabled bays\nMovement - All ships execute movement intent for this slot (speed order)\nCollisions - Resolve ships at same position\nWeapons Fire - Ships with fire enabled attempt to shoot\nDogfights - Adjacent enemy ships may engage\n\nSpeed-Based Movement\nShips move in order of speed (highest first):\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nShip TypeSpeedNotesInterceptor5Fastest - moves firstScout4Fast reconGunship3MediumBomber2Slow but powerfulCarrier1Slowest - moves last\nTies broken alphabetically by ship ID for determinism.\nMovement Blocking\nWith single-occupancy rules:\n\nShips cannot move into occupied cells\nBlocked ships stay in their current position\nFacing is preserved (no forced rotation)\nPlan your fleet’s movement to avoid congestion\n\n\nNote: Capital ship collisions still apply when large ships attempt to occupy the same cell during simultaneous movement resolution.\n\nWeapons Fire\nShips with fire enabled for this sub-phase:\n\nAuto-target nearest enemy in weapon arc\nRange varies by weapon type (default: 3 cells)\nAmmo consumed per shot\nDamage calculated: ATK + Roll - DEF\n\n\nUpkeep Phase\nEnd-of-turn maintenance:\nComponent Repair\nDamaged components have a chance to self-repair:\nBase Repair Chance: 5% per turn\nModifiers:\n\nPilot perks: +10-30%\nShip upgrades: +5-15%\nCarrier nearby (RECOVER mode): +20%\n\nRepair Effects:\n\nRestores 33% component health\nClears disabled/jammed status\nUpdates movement slots if engine repaired\n\nOther Upkeep\n\nAdvance jump drive charge\nSpawn reinforcements (if any)\nCheck victory/defeat conditions\nAdvance turn counter\n\n\nDamage &amp; Combat\nDamage Formula\nDamage = max(0, DiceRoll + ATK - DEF)\n\nRPS Triangle (Dogfights)\nWhen adjacent ships engage:\nInterceptor &gt; Bomber &gt; Gunship &gt; Interceptor\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMatchupAttacker DieAdvantaged10Neutrald6Disadvantaged4\n\nLanding Ships\nShips can return to carrier using the LAND intent:\nRequirements:\n\nShip must be adjacent to carrier\nCarrier bay must have capacity\nShip must be “small” class (fighters)\n\nLanding Flow:\n\nAssign LAND intent in action queue\nDuring resolution, ship moves to carrier position\nShip becomes docked (removed from grid)\nCan be re-launched on future turns\n\n\nWin/Lose Conditions\nWin:\n\nAll enemies destroyed, OR\nSurvive until jump drive charged (escape scenario)\n\nLose:\n\nCarrier destroyed (HP reaches 0)\nNo fuel and no squadrons (stranded)\n\n\nReinforcements\nBattles may feature multiple waves of enemies. See Reinforcement System for details.\nWave Triggers:\n\nTurn threshold (after X turns)\nEnemy casualties (when losses exceed %)\nCarrier damage (when enemy carrier hit)\nDistress beacon (enemy unit calls for help)\n\nEncounter Types:\n\nStandard: 0-1 waves\nAmbush: 1-2 waves (aggressive)\nElite: 1 wave (hunter trait)\nBoss: 2-3 waves (distress beacon)\n\n\nCapital Ship Combat\nDirectional Damage\nWhen attacking capital ships, damage is applied to the sector facing the attacker:\n        FRONT\n    +----------+\n L  | L  C  R  |  R\n E  |    O     |  I\n F  |    R     |  G\n T  |    E     |  H\n    +----------+  T\n        REAR\n\n\nAttack direction determined by relative position\nOuter components in that sector hit first\nDamage flows inward toward Hull Core\nSector disabled at 50% damage\n\nSee Carriers - Directional Damage for sector effects.\nCapital Collisions\nWhen two capital ships occupy the same cell:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nEventDamageBase collision2 + size differenceSmaller ship+1 extra damageEdge blocked+2 instead of pushback\nBoth ships are pushed 1 tile apart. Collisions can chain (max depth 2) if pushed into another ship."},"game-design/factions":{"slug":"game-design/factions","filePath":"game-design/factions.md","title":"Factions","links":["game-design/carriers"],"tags":[],"content":"Factions\nExodus Loop features two distinct factions, each with unique unit naming, visual styling, and combat traits.\n\nHuman Fleet (Player)\nThe remnants of humanity’s carrier fleet, featuring advanced but aging technology.\nUnit Naming\nHuman squadrons use standard NATO-style callsigns:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTypeCallsign PatternExampleInterceptorI-[Phonetic]-[#]I-Alpha-1BomberB-[Phonetic]-[#]B-Bravo-2GunshipG-[Phonetic]-[#]G-Charlie-3FrigateF-[Phonetic]-[#]F-Delta-4DestroyerD-[Phonetic]-[#]D-Echo-5ScoutS-[Phonetic]-[#]S-Foxtrot-6MinerM-[Phonetic]-[#]M-Golf-7\nVisual Style\n\nHP Bar Color: Blue/Cyan\nGrid Tokens: Standard geometric icons\nCarrier: Player’s carrier uses Carrier Class styling\n\n\nNautolan Faction (Enemy)\nAn alien bio-organic faction using swarm tactics and regenerative bio-ships.\nEncounter Trigger\nNautolan encounters spawn when:\n\nNode type is “ALIEN”\nScenario type begins with “alien_” (e.g., “alien_standard”)\n\nUnit Naming\nNautolan units use bio-organic names:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nHuman EquivalentNautolan NameIconInterceptorStinger~BomberSpitter*GunshipBrute#FrigateSymbiotehexagonDestroyerLurker=ScoutPsion?MinerHarvestercircled dot\nVisual Style\n\nHP Bar Color: Purple (0.6, 0.2, 0.8)\nGrid Tokens: Bio-organic symbols\nDistinct naming for visual differentiation\n\nNautolan Carrier: Leviathan\nThe Leviathan is the Nautolan capital ship variant:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nStatValueComparisonHull8Lower than Standard (10)Hangar6Higher than Standard (4)Reinforce Rate70%Higher than Standard (50%)IconhexagonBio-organic designDefault TraitAGGRESSIVESwarm behavior\nSpecialty: The Leviathan trades durability for overwhelming squadron deployment. Expect constant reinforcements and swarm tactics.\nNautolan Traits\nShips spawned from Nautolan carriers may have these faction-specific traits:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTraitEffectRegenerationHeals 1 HP per turnSwarm Tactics+1 ATK when adjacent to allyBio-ArmorFirst damage each turn reduced by 1Spore CloudOn death, adjacent enemies take 1 damage\n\nFaction Detection\nFaction is set on enemy spawn based on:\n# In enemy.gd\nif scenario_type.begins_with(&quot;alien_&quot;):\n    squadron.faction = &quot;nautolan&quot;\nelse:\n    squadron.faction = &quot;human&quot;\nAll faction-specific naming, icons, and HP bar colors are derived from this faction property.\n\nFuture Factions\nPlanned factions for future updates:\n\nRogue AI - Mechanical precision, predictable patterns\nPirate Fleet - Varied salvaged ships, opportunistic tactics\nAssimilators - The primary antagonist, Borg-like adaptation\n"},"game-design/index":{"slug":"game-design/index","filePath":"game-design/index.md","title":"Game Design Document v1.0","links":["game-design/squadrons","game-design/carriers","game-design/combat","game-design/pilots","game-design/progression","game-design/achievements","game-design/balance","game-design/factions"],"tags":[],"content":"Exodus Loop - Game Design Document v1.0\nVersion: 1.3 (reflects implementation as of v0.5.30)\nLast Updated: 2026-01-28\nEngine: Godot 4.5 (GDScript)\nPlatforms: iOS, Android\n\nThis GDD documents the actual implementation, not the original design vision. For the original MVP scope document, see docs/GDD_ORIGINAL.md in the repository.\n\n\nHigh Concept\nYou are the captain of humanity’s last carrier, escorting refugee fleet survivors fleeing a Borg-like assimilating enemy. When you die, you wake up at the beginning—Edge of Tomorrow style—retaining knowledge and eventually sharing your time-loop power with elite pilots.\nCore Fantasy: Desperate tactical commander making impossible choices with limited resources.\n\nCore Loop\nNODE MAP --&gt; SETUP PHASE --&gt; COMBAT --&gt; REWARDS --&gt; NODE MAP\n                                                      |\nOn Death: XP awarded --&gt; Meta upgrades --&gt; New Run ---+\n\nEach run progresses through a procedurally generated node map. Battles use turn-based tactical combat on a variable N×M grid (default 11×13 for campaign). Between runs, XP purchases permanent upgrades, and successful extraction adds components to your persistent Exodus Fleet.\n\nImplementation vs Original Design\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAspectOriginal MVPCurrent ImplementationSquadron Types3 (RPS triangle)7 (3 RPS + 4 specialist)Carrier Types1 (fixed)4 (Scout, Standard, Battle, Tender)Meta Upgrades1-222 with prerequisitesCombat ResolutionSimultaneousSequential (initiative-based)Grid Size5×7 fixedVariable N×M (11×13 campaign)Pilot SystemPost-MVPFully implementedAdmiral SkillsNot planned6 skills across 3 tiersBlessed SquadronsPost-MVPImplementedSensor TiersNot planned5 tiers (0-4)AchievementsNot planned6 achievementsTutorialBasicGuided demonstration with 9 stepsDirectional DamageNot planned5-sector damage modelCapital CollisionsNot plannedChain collision systemExodus FleetNot plannedComponent extraction metaReinforcementsNot plannedMulti-wave battlesCraftingNot plannedBlueprint systemAlien FactionsNot plannedNautolan factionFleet ManagementNot plannedDock/Escort locations\n\nSections\n\nSquadron Types - All 7 types with stats and abilities\nCarrier Types - 4 player carrier types and enemy carriers\nCombat System - Preparation phase, sequential resolution, damage formulas\nPilot System - Perks, morale, permadeath, blessed mechanics\nProgression - 22 upgrades, Admiral skill tree\nAchievements - 6 unlockable achievements\nBalance Constants - Extracted magic numbers\nFactions - Human and Nautolan alien faction\n\n\nReferences &amp; Inspiration\n\nFTL - Crew management, desperation, node map\nMonster Train - Wave defense, unit placement\nInto the Breach - Turn-based tactics, information clarity\nBattlestar Galactica - Tone, fleet survival, carrier operations\nEdge of Tomorrow - Time loop narrative justification\n"},"game-design/pilots":{"slug":"game-design/pilots","filePath":"game-design/pilots.md","title":"Pilot System","links":[],"tags":[],"content":"Pilot System\nPilots are named characters that can be assigned to squadrons, providing stat bonuses, perks, and persistent progression across runs.\nPilot Stats\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nStatDescriptionnameCallsign (from pool of 20)perksArray of PerkType (1-3 slots based on level)xpExperience pointslevelCurrent level (1-5)morale0-100 scalepassive_abilityUnlocked at level 4+killsEnemy squadrons destroyedmissionsMissions survivedis_alivePermadeath stateis_carried_overVeteran roster persistence\n\nPilot Perks\nPilots gain perk slots as they level: 1 slot at L1, 2 at L2, 3 at L3+.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPerkStat BonusDescriptionSTEADY_AIM+1 ATKPatient targeting yields consistent hitsEVASIVE+1 DEFAlways watching the blind spotsQUICK_REFLEXES+1 SPDFirst to react, last to fallIRON_WILL+1 HullRefuses to eject until mission completeFUEL_EFFICIENT+1 FuelCoasts on fumes when others would crash\nPerks stack with multiple slots. A level 3 pilot could have:\n\nSTEADY_AIM (+1 ATK)\nEVASIVE (+1 DEF)\nQUICK_REFLEXES (+1 SPD)\n\nNo duplicate perks allowed on the same pilot.\n\nLevel Progression\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLevelXP RequiredRank NamePerk Slots10Rookie1250Veteran23150Ace34300Elite35500Legend3\nXP Awards\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nEventXP GainedMission survival25 (50 for boss)Enemy kill10Run completion bonus25\n\nMorale System\nMorale ranges from 0-100 and affects combat performance.\nMorale Thresholds\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMoraleATK ModifierDEF ModifierHigh (≥80)+10Normal (21-79)00Low (≤20)-1-1\nMorale Changes\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nEventChangeVictory (mission survived)+10Enemy kill+5Damage taken-5 per HP lostAlly squadron destroyed-15 (all pilots)Escort destroyed-10\n\nPassive Abilities\nAutomatically unlocked when pilot reaches Level 4+. Based on primary perk (first in array).\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPrimary PerkAbilityEffectSTEADY_AIMCritical Eye20% chance for +2 damage on hitEVASIVEAfterburnerOnce per battle, ignore one attackQUICK_REFLEXESFirst Strike+2 initiative on turn 1IRON_WILLLast Stand+2 DEF when below 50% hullFUEL_EFFICIENTExtended Range+1 movement range\n\nPermadeath\nWhen a pilot’s squadron is destroyed:\n\n\nCheck Eject Protocol (Admiral skill, if unlocked)\n\n20% survival chance\nIf successful: pilot unassigned but alive\nIf failed: proceed to step 2\n\n\n\nPermadeath\n\nis_alive set to false\nRemoved from pilot_roster\nAdded to deceased_pilots\nVisible in Hall of Fame\n\n\n\nDead pilots do NOT carry over between runs.\n\nVeteran Roster (Cross-Run Persistence)\nRequires meta-upgrade unlocks:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nUpgradeCostEffectveteran_roster_1100 XP1 pilot carries overveteran_roster_2150 XP2 pilots carry overveteran_roster_3150 XP3 pilots carry over\nCarried-over pilots:\n\nRetain level, XP, perks, passive ability\nReset morale to 100\nClear kills/missions for new run\n\n\nCallsign Pool\n20 available callsigns:\nMaverick, Iceman, Goose, Viper, Jester,\nPhoenix, Rooster, Hangman, Ace, Ghost,\nReaper, Hawk, Shadow, Storm, Thunder,\nLightning, Blaze, Frost, Nova, Comet\n\n\nAdmiral Eject Protocol\nThe Admiral’s “Eject Protocol” skill provides pilot survival chance:\n\nTier: 2 (requires 1 tier 1 skill)\nValue: 0.20 (20% chance)\nEffect: When squadron destroyed, 20% chance pilot survives\n\nThis is the primary defense against permadeath and makes leveling the Admiral crucial for pilot retention."},"game-design/progression":{"slug":"game-design/progression","filePath":"game-design/progression.md","title":"Progression System","links":[],"tags":[],"content":"Progression System\nExodus Loop features extensive meta-progression through 22 upgrades and a 6-skill Admiral tree.\nMeta-Upgrades (22 Total)\nTier 1 - 5 Upgrades (50 XP each, no prerequisites)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIDNameEffectreinforced_hull_1Reinforced Hull I+5 Carrier HPsupply_cache_1Supply Cache+3 Metal, +3 Energy at run startsensors_1Sensors IReveal enemy aggression levelsveteran_pilots_1Veteran PilotsSquadrons start with +1 HPbuoy_capacityBuoy Capacity+2 max recon buoys per battle (3→5)\nTier 2 - 10 Upgrades (75-100 XP)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIDNameCostPrereqEffectreinforced_hull_2Reinforced Hull II75reinforced_hull_1+5 more Carrier HPfuel_reserves_1Fuel Reserves75supply_cache_1+1 Fuel at run startsensors_2Sensors II100sensors_1Reveal enemy movement pathsexpanded_hangar_1Expanded Hangar75veteran_pilots_1+2 Hangar capacity (3→5)salvage_expertise_1Salvage Expertise75supply_cache_1+25% salvage resourcespoint_defense_plus_1Point Defense+100reinforced_hull_1Destroy enemies with HP ≤ 4shield_burst_1Shield Generator100reinforced_hull_1Absorb 3 damage once per battlepilot_recruitment_1Field Recruiting75veteran_pilots_1Rest stops offer pilots (50% chance)long_range_sensorsLong Range Sensors75sensors_1Carrier detection range +1sensor_arraySensor Array100sensors_2All units detection range +1\nTier 3 - 4 Upgrades (100-150 XP)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIDNameCostPrereqEffectsensors_3Sensors III150sensors_2Reveal enemy fuel levelsblessed_squadron_1Blessed Squadron150veteran_pilots_1 + expanded_hangar_11 squadron persists between runsloadout_customization_1Custom Loadout150expanded_hangar_1Choose starting squadronsveteran_roster_1Veteran Roster I100veteran_pilots_11 pilot carries over between runs\nTier 4 - 3 Upgrades (150-200 XP)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIDNameCostPrereqEffectveteran_roster_2Veteran Roster II150veteran_roster_12 pilots carry overveteran_roster_3Veteran Roster III150veteran_roster_23 pilots carry oversensors_4Sensors IV200sensors_3Reveal enemy intent/actions\n\nUpgrade Tree Structure\ngraph TD\n    subgraph Hull Branch\n        RH1[reinforced_hull_1] --&gt; RH2[reinforced_hull_2]\n        RH1 --&gt; PD[point_defense_plus_1]\n        RH1 --&gt; SB[shield_burst_1]\n    end\n\n    subgraph Supply Branch\n        SC1[supply_cache_1] --&gt; FR1[fuel_reserves_1]\n        SC1 --&gt; SE1[salvage_expertise_1]\n    end\n\n    subgraph Sensor Branch\n        S1[sensors_1] --&gt; S2[sensors_2]\n        S2 --&gt; S3[sensors_3]\n        S3 --&gt; S4[sensors_4]\n        S1 --&gt; LRS[long_range_sensors]\n        S2 --&gt; SA[sensor_array]\n    end\n\n    subgraph Pilot Branch\n        VP1[veteran_pilots_1] --&gt; EH1[expanded_hangar_1]\n        VP1 --&gt; PR1[pilot_recruitment_1]\n        VP1 --&gt; VR1[veteran_roster_1]\n        VR1 --&gt; VR2[veteran_roster_2]\n        VR2 --&gt; VR3[veteran_roster_3]\n        EH1 --&gt; LC1[loadout_customization_1]\n        VP1 --&gt; BS1[blessed_squadron_1]\n        EH1 --&gt; BS1\n    end\n\nKey Hub Upgrades:\n\nexpanded_hangar_1: Required for both blessed_squadron_1 AND loadout_customization_1\nsensors_2: Gateway to sensor_array AND sensors_3\n\nLongest Path: sensors_1→2→3→4 (4 steps, 500 XP total)\n\nSensor Tier System\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTierUpgradeCumulative CostInformation Revealed0——Basic combat info only1sensors_150Enemy aggression levels2sensors_2150+ Enemy movement paths3sensors_3300+ Enemy fuel levels4sensors_4500+ Enemy intent/actions\nSensor tier only reveals information—it doesn’t lock gameplay content.\n\nAdmiral Skill Tree\nLeveling\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLevelXP for NextCumulative XP0 → 11001001 → 22503502 → 34508003 → 470015004 → 5100025005 → 615004000\nMax Level: 6\nSkill Points: 1 per level (6 total)\nSkills (SURVIVAL_FIRST Branch)\nTier 1 (Available Immediately)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSkillStatValueDescriptionLAST_STANDatk_bonus_low_hp+1 ATKSquadrons gain +1 ATK when below 50% HPEMERGENCY_REPAIRScarrier_heal_end+1 HPCarrier heals 1 HP at end of battle if damaged\nTier 2 (Require 1 Tier 1)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSkillStatValueDescriptionEJECT_PROTOCOLpilot_survival_chance0.2020% chance pilot survives squadron deathRALLY_CRYfirst_squadron_ap+1 APFirst squadron each battle gets +1 AP\nTier 3 (Require 1 Tier 2)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSkillStatValueDescriptionIRON_WILLcarrier_first_hit_reduction-1 dmgCarrier takes -1 damage from first hitDESPERATE_MEASURESatk_bonus_carrier_critical+2 ATKSquadrons deal +2 damage when carrier below 25% HP\n\nBlessed Squadrons\nUnlock: blessed_squadron_1 (150 XP, requires veteran_pilots_1 + expanded_hangar_1)\nMechanics:\n\n1 squadron slot available when unlocked\nBlessed squadrons persist between runs\nStats frozen at time of blessing\nPilot assignment retained (if pilot alive and carried over)\n\nBlessing Process:\n\nComplete run (survive or die)\nSelect surviving squadron on BlessedSelectionScreen\nSquadron saved to meta-progression\nAutomatically added to hangar on next run start\n\n\nStarting Resources\nBase (no upgrades):\n\nMetal: 10\nEnergy: 10\nFuel: 10\nFood: 5\nGlobal Ammo: 5\n\nWith supply_cache_1: +3 Metal, +3 Energy\nWith fuel_reserves_1: +1 Fuel\nHangar Capacity:\n\nBase: 3 squadrons\nWith expanded_hangar_1: 5 squadrons\n\n\nExodus Fleet (Extraction System)\nThe Exodus Fleet is a persistent collection of components and carrier builds that spans across runs.\nCore Mechanics\n\nExtraction: Mark ONE component for extraction before each battle\nSuccess: If the run succeeds (victory OR escape), marked component joins your Exodus Fleet\nRisk: If carrier is destroyed, ALL equipped Exodus Fleet components are LOST FOREVER\n\nComponent Rarity\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRarityDrop RateStat BonusSpecial TraitsCOMMON50%+0%NoneUNCOMMON30%+10%1 minor traitRARE15%+25%1 major traitEPIC4%+40%2 traitsLEGENDARY1%+60%Unique ability\nComponent Draw at Run Start\n\nSelect carrier class (Scout, Standard, Battle, Tender)\nReceive guaranteed pieces from class template\nDraw bonus components from class-weighted pool\nOptionally equip components from Exodus Fleet (at risk!)\nPlace all components in Ship Builder V2\n\nFleet Management Screen\nAccess the Exodus Fleet from the title screen to:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTabFunctionComponentsBrowse all extracted components, filter by type/rarityCarriersLoad saved carrier buildsWorkshopRepair damaged components, salvage for materialsStatsFleet value, extraction history, losses\nSaved Carrier Builds\n\nSave complete carrier configurations with name and tags\nQuick-load builds at run start\nMultiple builds per class type\n\nRepair &amp; Salvage\nRepair: Fix damaged components using Metal (cost scales with damage)\nSalvage: Destroy unwanted components for Metal:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRarityBase ValueCommon5 MetalUncommon15 MetalRare30 MetalEpic60 MetalLegendary150 Metal\nDamaged components yield reduced salvage value."},"game-design/squadrons":{"slug":"game-design/squadrons","filePath":"game-design/squadrons.md","title":"Squadron Types","links":[],"tags":[],"content":"Squadron Types\nExodus Loop features 7 squadron types: 3 in the RPS triangle (Interceptor, Bomber, Gunship) and 4 specialist types outside it (Frigate, Destroyer, Scout, Miner).\nStat Overview\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTypeSPDATKDEFHullAmmoFuelMoveDetectionSpecialInterceptor31133521Fuel EfficiencyBomber13143211Heavy PayloadGunship22353311Regen ArmorFrigate21245412Fire Control NetworkDestroyer23153311Torpedo SalvoScout41122523Extended SensorsMiner10130411Resource Extraction\n\nRPS Triangle Types\nInterceptor (Type Code: I)\nRole: Fast anti-air fighter with high initiative\n\nStats: SPD 3, ATK 1, DEF 1, Hull 3, Ammo 3, Fuel 4→5, Move 2\nRPS: Beats Bomber, loses to Gunship\nPassive: “Fuel Efficiency” - +1 Max Fuel (4→5)\nCost: 2 Metal\n\nInterceptors excel at hunting down Bombers and have the highest initiative in the RPS triangle. Their extended movement range (2 cells) allows quick repositioning.\nBomber (Type Code: B)\nRole: Heavy damage dealer, carrier killer\n\nStats: SPD 1, ATK 3, DEF 1, Hull 4, Ammo 2→3, Fuel 2, Move 1\nRPS: Beats Gunship, loses to Interceptor\nPassive: “Heavy Payload” - +1 Max Ammo (2→3)\nCost: 2 Energy\n\nBombers deal the highest damage in the game (ATK 3) but are slow and vulnerable to Interceptors. Position them carefully behind defensive lines.\nGunship (Type Code: G)\nRole: Balanced tank with defensive stance\n\nStats: SPD 2, ATK 2, DEF 3, Hull 5, Ammo 3, Fuel 3, Move 1\nRPS: Beats Interceptor, loses to Bomber\nPassive: “Regenerative Armor” - Heal 1 HP at end of each turn\nCost: 1 Metal + 1 Energy\n\nGunships are the tankiest RPS unit with the highest DEF (3) and Hull (5). Their regeneration makes them excellent for holding positions.\n\nSpecialist Types (Outside RPS)\nFrigate (Type Code: F)\nRole: Command escort &amp; tactical coordinator\n\nStats: SPD 2, ATK 1, DEF 2, Hull 4, Ammo 5, Fuel 4, Move 1, Detection 2\nRPS: None - always rolls d6\nPassive: “Fire Control Network (FCN)” - Adjacent friendly squadrons gain +1 ATK when Frigate is in DEFEND mode\nCost: 2 Metal + 1 Energy\nRestriction: Cannot land on carrier (capital ship)\n\nFCN Mechanics:\n\nActivates only when Frigate is in DEFEND action\nAffects orthogonal neighbors (Manhattan distance 1)\nStacks with multiple Frigates\nFrigate does NOT buff itself\n\nDestroyer (Type Code: D)\nRole: Heavy assault &amp; torpedo platform (glass cannon)\n\nStats: SPD 2, ATK 3, DEF 1, Hull 5, Ammo 3, Fuel 3, Move 1\nRPS: None - always rolls d6\nPassive: “Torpedo Salvo” - Primary target’s DEF reduced by 1, splash damage to adjacent enemies\nCost: 2 Metal + 1 Energy\n\nDestroyers share the highest ATK (3) with Bombers but trade type advantage for armor-piercing capability.\nScout (Type Code: S)\nRole: Fast reconnaissance &amp; fog of war clearer\n\nStats: SPD 4, ATK 1, DEF 1, Hull 2, Ammo 2, Fuel 5, Move 2, Detection 3\nRPS: None - always rolls d6\nPassive: “Extended Sensors” - Reveals fog of war in 3-cell radius\nCost: 1 Metal + 1 Energy\n\nScouts have the highest SPD (4) and Detection (3) but are extremely fragile (Hull 2). Use them for reconnaissance, not combat.\nMiner (Type Code: M)\nRole: Resource extractor (non-combat utility)\n\nStats: SPD 1, ATK 0, DEF 1, Hull 3, Ammo 0, Fuel 4, Move 1\nRPS: None - cannot attack\nPassive: “Resource Extraction” - Can harvest adjacent asteroids\nCost: Deployment-dependent\n\nMiners have no combat capability (ATK 0, Ammo 0). They exist solely for resource gathering from harvestable asteroids.\n\nRPS Advantage System\ngraph LR\n    I[Interceptor] --&gt;|Beats| B[Bomber]\n    B --&gt;|Beats| G[Gunship]\n    G --&gt;|Beats| I\n\nDamage Dice:\n\nAdvantage: Roll d10 (1-10 range)\nNeutral: Roll d6 (1-6 range)\nDisadvantage: Roll d4 (1-4 range)\n\nFrigate, Destroyer, Scout, and Miner always roll d6 (neutral).\n\nNaming Convention\nCallsign Format: [Type Code]-[Wing Letter]-[Wing Number]\nExamples:\n\nI-Alpha-1 (Interceptor #1 from Alpha wing)\nD-Bravo-3 (Destroyer #3 from Bravo wing)\nS-Charlie-2 (Scout #2 from Charlie wing)\n\nWing Letters: Alpha, Bravo, Charlie, Delta, Echo, Foxtrot, Golf, Hotel, India, Juliet, Kilo, Lima\n\nAbility Summary\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTypeAbilityTriggerEffectInterceptorFuel EfficiencyPassive (creation)+1 Max Fuel permanentlyBomberHeavy PayloadPassive (creation)+1 Max Ammo permanentlyGunshipRegenerative ArmorUpkeep (each turn)Heal 1 HP (capped at max)FrigateFire Control NetworkWhen in DEFEND+1 ATK to adjacent alliesDestroyerTorpedo SalvoOn AttackDEF-1 on target, splash to adjacentScoutExtended SensorsAlways activeFog clear radius 3MinerResource ExtractionActionHarvest adjacent asteroids"},"index":{"slug":"index","filePath":"index.md","title":"Exodus Loop Documentation","links":["game-design/","game-design/squadrons","game-design/combat","game-design/pilots","game-design/progression","developer-guide/","developer-guide/architecture","developer-guide/screens","developer-guide/combat-system","developer-guide/save-system","internal/tech-debt","internal/exodus-fleet","internal/reinforcements","internal/crafting"],"tags":[],"content":"Exodus Loop\nA Godot 4.5 mobile roguelike where you command a carrier fleet escaping through hostile space.\nWelcome to the official documentation for Exodus Loop. This site contains the Game Design Document (GDD v1.0) reflecting the actual implementation, developer guides for onboarding, and technical references.\nQuick Links\nGame Design\n\nGame Design Document - Complete GDD v1.0\nSquadron Types - All 7 squadron types with stats\nCombat System - Sequential combat mechanics\nPilot System - Perks, morale, permadeath\nProgression - 22 upgrades, Admiral skills\n\nDeveloper Guide\n\nGetting Started - Development setup\nArchitecture - Autoloads, signals, patterns\nScreen Navigation - State machine and flow\nCombat Implementation - Phase breakdown\nSave System - Schema and migration\n\nInternal\n\nTech Debt Tracker - Prioritized issues\nExodus Fleet System - Meta-progression fleet extraction\nReinforcement System - Multi-wave battle encounters\nCrafting System - Blueprint-based component crafting\nGitHub Repository\n\n\nCore Fantasy\nYou are the captain of humanity’s last carrier, escorting refugee fleet survivors fleeing a Borg-like assimilating enemy. When you die, you wake up at the beginning—Edge of Tomorrow style—retaining knowledge and eventually sharing your time-loop power with elite pilots.\nSession Length: 5 minutes (quick death) to 15+ minutes (full run)\nCurrent Version\nVersion: 0.5.29\nEngine: Godot 4.5 (GDScript)\nPlatforms: iOS, Android (single codebase)\nResolution: 720x1280 (9:16 portrait, mobile-first)\n\nThis documentation reflects the actual implementation as of version 0.5.29."},"internal/crafting":{"slug":"internal/crafting","filePath":"internal/crafting.md","title":"Crafting System","links":[],"tags":[],"content":"Crafting System\nThe crafting system allows players to build new ship components using blueprints and resources collected during runs.\n\nBlueprint System\nObtaining Blueprints\nBlueprints drop from destroying capital ships:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSourceDrop ChanceMax DropsEnemy Carrier15%1 per battleElite Carrier20%1 per battleBoss Carrier25% + guaranteed1 per battle\nDropped blueprints are randomly selected from the unowned pool in the Blueprint Registry.\nBlueprint Registry\nAll available blueprints are stored in the registry:\nclass BlueprintRegistry:\n    var all_blueprints: Dictionary  # {id: BlueprintData}\n    var owned_blueprints: Array[String]  # Unlocked IDs\n \n    func get_unowned() -&gt; Array[BlueprintData]\n    func unlock(blueprint_id: String) -&gt; void\nBlueprint Data\nclass BlueprintData:\n    var id: String\n    var component_type: ComponentType\n    var shape: ShapeType\n    var base_stats: Dictionary\n    var material_cost: Dictionary  # {Metal: X, Energy: Y}\n    var build_time: int  # Battles to complete\n    var rarity_tier: Rarity\n\nBuild Queue\nQueue Management\n\nMax Concurrent Builds: 3\nBuild Time: Measured in battles completed\nProgress: Each battle advances all builds by 1\n\nclass BuildQueueManager:\n    var queue: Array[BuildQueueEntry]  # Max 3\n \n    func start_build(blueprint: BlueprintData) -&gt; bool\n    func advance_queue() -&gt; Array[CompletedBuild]\n    func cancel_build(entry_id: String) -&gt; Dictionary  # Returns refund\nBuild Queue Entry\nclass BuildQueueEntry:\n    var id: String\n    var blueprint_id: String\n    var progress: int  # Battles completed\n    var required: int  # Total battles needed\n    var pre_rolled_traits: Array[String]\n    var started_at: int  # Unix timestamp\nTrait Pre-Rolling\nWhen a build starts, traits are pre-rolled based on rarity:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRarityTrait SlotsRoll PoolCOMMON0NoneUNCOMMON1Minor traitsRARE1Major traitsEPIC21 minor + 1 majorLEGENDARY22 major + unique chance\nTraits are revealed when the build completes.\n\nResource Costs\nBy Component Type\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTypeMetalEnergyBuild TimeARMOR201 battleENGINE222 battlesREACTOR312 battlesHANGAR222 battlesWEAPON_BAY323 battlesSENSOR_ARRAY132 battlesBRIDGE222 battlesCREW_QUARTERS111 battleENGINEERING212 battles\nRarity Multiplier\nHigher rarity blueprints cost more:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRarityCost MultiplierCOMMON1.0xUNCOMMON1.5xRARE2.0xEPIC3.0xLEGENDARY5.0x\n\nCancellation &amp; Refunds\nCanceling a build returns 50% of materials:\nfunc cancel_build(entry_id: String) -&gt; Dictionary:\n    var entry = _get_entry(entry_id)\n    var refund = {\n        &quot;Metal&quot;: floor(entry.metal_cost * 0.5),\n        &quot;Energy&quot;: floor(entry.energy_cost * 0.5)\n    }\n    queue.erase(entry)\n    return refund\nNote: Build progress is lost entirely. No partial completion bonus.\n\nCompleted Builds\nWhen a build completes:\n\nComponent added to inventory (not Exodus Fleet)\nPre-rolled traits are assigned\nPlayer notified via completion modal\nComponent available for ship builder\n\nCompletion Flow\nfunc _on_battle_completed() -&gt; void:\n    var completed = build_queue.advance_queue()\n    for build in completed:\n        var component = _create_component(build)\n        inventory.add(component)\n        _show_completion_modal(component)\n\nUI Integration\nBuild Queue Panel\nShown in Fleet Management screen:\n┌─────────────────── BUILD QUEUE ───────────────────┐\n│ [1] ENGINE (Rare)        [███████░░░] 7/10       │\n│ [2] WEAPON_BAY (Common)  [██████████] COMPLETE!  │\n│ [3] Empty slot           [+ Add Build]           │\n└───────────────────────────────────────────────────┘\n\nBlueprint Selection\nWhen starting a build:\n\nShows all owned blueprints\nDisplays resource cost\nShows estimated completion (battles)\nPreview trait roll chances\n\n\nIntegration Points\nBlueprintDropCalculator\n# In blueprint_drop_calculator.gd\nfunc calculate_drop(carrier: EnemyCarrier) -&gt; BlueprintData:\n    var chance = BASE_DROP_CHANCE  # 15%\n    if carrier.is_elite:\n        chance += 0.05\n    if carrier.is_boss:\n        chance += 0.10\n \n    if randf() &lt; chance:\n        return _get_random_unowned_blueprint()\n    return null\nSaveManager\n# Save version 14+\nfunc _serialize_build_queue() -&gt; Array\nfunc _deserialize_build_queue(data: Array) -&gt; void\nfunc _serialize_blueprints() -&gt; Dictionary\nfunc _deserialize_blueprints(data: Dictionary) -&gt; void\nGameState\n# After each battle\nfunc _on_battle_ended(victory: bool) -&gt; void:\n    if victory:\n        _check_blueprint_drop()\n        _advance_build_queue()\n\nDesign Goals\n\nSteady Progression - Regular blueprint drops keep players engaged\nMeaningful Choices - Limited queue slots force prioritization\nBattle Incentive - Build progress encourages fighting vs. avoiding\nRisk-Free Crafting - Crafted items go to inventory, not equipped (safe)\nComplementary to Extraction - Craft what you can’t extract\n"},"internal/exodus-fleet":{"slug":"internal/exodus-fleet","filePath":"internal/exodus-fleet.md","title":"Exodus Fleet System","links":[],"tags":[],"content":"Exodus Fleet System\nThe Exodus Fleet is a meta-progression system where players extract components from successful runs to build a persistent fleet inventory.\n\nCore Concept\nRisk/Reward Gameplay:\n\nMark ONE component for extraction before each battle\nRun success = marked component joins your Exodus Fleet\nRun failure (carrier destroyed) = ALL equipped Exodus Fleet components are LOST\n\nThis creates high-stakes decisions: equipping your best fleet components makes you stronger but risks losing them.\n\nComponent Extraction\nMarking Components\nDuring the POSITIONING phase of each battle:\n\nOpen the ship configuration view\nSelect a component to mark for extraction\nOnly ONE component can be marked per battle\nMarked components display an extraction icon\n\nExtraction Triggers\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nOutcomeResultBattle VictoryMarked component extractedBattle EscapeMarked component NOT extractedRun Complete (Boss Victory)All marked components + bonus extractionCarrier DestroyedALL equipped fleet components LOSTRun AbandonedNo extraction, no loss\n\nRarity System\nExtracted components have rarity tiers affecting their stats:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRarityDraw WeightStat BonusTraitsCOMMON50%+0%NoneUNCOMMON30%+10%1 minorRARE15%+25%1 majorEPIC4%+40%2 traitsLEGENDARY1%+60%Unique ability\nTrait Examples\nMinor Traits:\n\nReinforced (+5% durability)\nEfficient (-5% power cost)\nLightweight (+0.5 speed contribution)\n\nMajor Traits:\n\nOvercharged (+15% output)\nHardened (+15% durability)\nIntegrated (counts as 2 component types)\n\n\nExtractedComponent Class\nclass ExtractedComponent:\n    var id: String\n    var component_type: ComponentType\n    var rarity: Rarity\n    var shape: ShapeType\n    var traits: Array[String]\n    var damage_percent: float  # 0-100, affects stats\n    var extraction_run_id: String\n    var extraction_date: int  # Unix timestamp\n\nSavedCarrier Class\nPlayers can save complete carrier configurations:\nclass SavedCarrier:\n    var id: String\n    var name: String\n    var carrier_class: CarrierClassTemplate.CarrierClass\n    var components: Array[ExtractedComponent]\n    var creation_date: int\n    var total_runs: int\n    var total_victories: int\n\nExodus Fleet Screen\nAccess from the title screen or between runs:\nComponents Tab\n\nView all extracted components\nFilter by type (Engine, Weapon, Hangar, etc.)\nFilter by rarity\nSort by extraction date, rarity, or type\n\nCarriers Tab\n\nSave current carrier build as a template\nLoad saved builds for new runs\nView carrier statistics (runs, victories)\n\nWorkshop Tab\n\nRepair: Fix damaged components (costs Metal)\nSalvage: Break down components for Metal resources\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRaritySalvage ValueCOMMON1 MetalUNCOMMON2 MetalRARE4 MetalEPIC8 MetalLEGENDARY15 Metal\nStats Tab\n\nTotal fleet value\nExtraction history\nRarity breakdown pie chart\nComponents extracted per run\n\n\nIntegration Points\nGameState\n# In game_state.gd\nvar exodus_fleet: ExodusFleet\n \nfunc mark_for_extraction(component: DrawnComponent) -&gt; void\nfunc complete_extraction() -&gt; void\nfunc handle_carrier_destroyed() -&gt; void  # Removes equipped fleet components\nSaveManager\n# Save version 13+\nfunc _serialize_exodus_fleet() -&gt; Dictionary\nfunc _deserialize_exodus_fleet(data: Dictionary) -&gt; void\nComponentDrawManager\n# When starting a new run\nfunc equip_from_fleet(component_id: String) -&gt; bool\nfunc get_equipped_fleet_components() -&gt; Array[DrawnComponent]\n\nDesign Philosophy\nThe Exodus Fleet system creates meaningful meta-progression without trivializing individual runs:\n\nInvested Stakes - Using fleet components feels risky\nGradual Power Growth - Fleet grows slowly over many runs\nEmotional Attachment - Named components with history\nRecovery from Loss - Even losing components teaches what to save next time\nBuild Experimentation - Saved carriers encourage trying different strategies\n"},"internal/fleet-management":{"slug":"internal/fleet-management","filePath":"internal/fleet-management.md","title":"Fleet Management System","links":[],"tags":[],"content":"Fleet Management System\nSquadron location and state management for dock/undock operations between carriers and escort duty.\n\nOverview\nShips in your fleet can be in different locations relative to the carrier:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLocationDescriptionCombat StatusDOCKEDIn carrier hangarSafe, must launch to fightESCORTINGFlying alongside carrierOn grid, consumes fuel per jump\n\nLocation vs State\nImportant Distinction:\n\nLocation (ShipLocation enum): Where the ship physically is - DOCKED or ESCORTING\nState (Squadron.State enum): Operational status - READY, MOVING, ATTACKING, etc.\n\nA ship’s location determines whether it appears on the battle grid, while state tracks its in-combat actions.\n\nDocking &amp; Undocking\nDock (Escorting → Docked)\nMove a ship from escort duty into the carrier hangar:\nRequirements:\n\nShip must be in ESCORTING location\nCarrier hangar has available capacity\nMust have fleet actions remaining\n\nEffects:\n\nShip enters hangar (safe from grid combat)\nNo longer consumes fuel on jumps\nCan be launched during positioning/battle\n\nUndock (Docked → Escorting)\nDeploy a ship from hangar to escort duty:\nRequirements:\n\nShip must be in DOCKED location\nMust have fleet actions remaining\n\nEffects:\n\nShip joins escort fleet\nAppears on battle grid\nConsumes fuel on node jumps (+1 fuel per escort)\n\n\nFleet Actions\nFleet management uses an action economy system:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNode TypeActions AvailableCombat nodes1 actionSafe nodes (Rest, Shop)Unlimited\nActions that consume fleet actions:\n\nDock a ship\nUndock a ship\nRepair a ship (in Fleet Management screen)\nBuild a ship\n\n\nEscort Fuel Cost\nEscorts consume additional fuel on each node transition:\nTotal Fuel Cost = Base Cost + (Escort Count × 1)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nEscort CountAdded Cost0+01+12+23++3+\nThis creates strategic trade-offs:\n\nMore escorts = more firepower but higher fuel cost\nDock ships to conserve fuel on long journeys\nUndock before challenging encounters\n\n\nFleet Management Screen\nAccess via the FLEET button on the node map or after battle victories.\nTabs\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTabPurposeBuildCreate new squadrons (costs Metal/Energy)RepairFix damaged ships (1 Metal per HP)PilotsAssign/swap pilots between shipsStatsFleet overview and totals\nUI Elements\nShip Cards: Display each ship with:\n\nName and callsign\nHP bar (current/max)\nPilot assignment\nLocation badge (DOCKED/ESCORTING)\nDock/Undock button\n\nDock Button:\n\nVisible for ESCORTING ships\nDisabled if no fleet actions remain\nDisabled if hangar is full\n\nUndock Button:\n\nVisible for DOCKED ships\nDisabled if no fleet actions remain\n\n\nImplementation\nGameState Methods\n# Check if dock/undock is possible\nfunc can_dock_squadron(squad: Squadron) -&gt; bool\nfunc can_undock_squadron(squad: Squadron) -&gt; bool\n \n# Execute dock/undock\nfunc dock_squadron(squad: Squadron) -&gt; bool\nfunc undock_squadron(squad: Squadron) -&gt; bool\n \n# Fleet action economy\nfunc can_perform_fleet_action() -&gt; bool\nfunc consume_fleet_action() -&gt; void\nSquadron Fields\n# Ship location enum\nenum ShipLocation { DOCKED, ESCORTING }\n \n# Current location\nvar ship_location: ShipLocation = ShipLocation.DOCKED\nSave Version\nSquadron SAVE_VERSION: 7\n\nAdded ship_location field\n\nRUN_SAVE_VERSION: 9\n\nAdded fleet_actions_remaining to run state\n\n\nEscort Fuel Calculation\n# In game_state.gd\nfunc get_escort_count() -&gt; int:\n    var count := 0\n    for squad in squadron_roster:\n        if squad.ship_location == Squadron.ShipLocation.ESCORTING:\n            count += 1\n    return count\n \nfunc calculate_jump_fuel_cost(base_cost: int = 1) -&gt; int:\n    return base_cost + get_escort_count()\n\nBattle Integration\nPositioning Phase\n\nESCORTING ships start on grid (deployment zone)\nDOCKED ships remain in carrier hangar\nShips with “Early Launch” trait can deploy from hangar\n\nCombat Phase\n\nOnly ESCORTING ships participate in grid combat\nDOCKED ships are safe until launched\nLaunched ships become ESCORTING for the battle duration\n\nPost-Battle\n\nSurviving ships retain their location state\nDestroyed ships are removed from roster\nFlee to Fleet Management screen for reorganization\n\n\nDesign Rationale\nThe fleet ownership model provides:\n\nTactical Depth - Choose which ships to expose vs protect\nResource Management - Fuel cost trade-offs\nStrategic Planning - Pre-position fleet for upcoming encounters\nRisk Mitigation - Keep valuable ships docked during risky jumps\n\n\nLast Updated: 2026-01-28\nImplementation Version: 0.5.30"},"internal/index":{"slug":"internal/index","filePath":"internal/index.md","title":"Internal Systems","links":["internal/exodus-fleet","internal/crafting","internal/fleet-management","internal/reinforcements","internal/tech-debt","developer-guide/architecture","game-design/carriers","game-design/combat"],"tags":[],"content":"Internal Systems\nTechnical documentation for internal game systems and meta-progression features.\n\nMeta-Progression Systems\nExodus Fleet System\nPersistent component extraction across runs:\n\nMark components for extraction during battle\nSuccessful runs add components to fleet\nFailed runs LOSE equipped fleet components\nRarity tiers with stat bonuses and traits\n\nCrafting System\nBlueprint-based component crafting:\n\nBlueprints drop from destroyed capital ships\nBuild queue (max 3 concurrent builds)\nBuild progress measured in battles\nCrafted components go to safe inventory\n\n\nBattle Systems\nFleet Management System\nSquadron location and dock/undock operations:\n\nDOCKED vs ESCORTING ship locations\nFleet action economy (limited at combat nodes)\nEscort fuel cost mechanics\nFleet Management screen with Build/Repair/Pilots/Stats tabs\n\nReinforcement System\nMulti-wave encounter management:\n\n6 trigger types (turn, casualties, beacon, etc.)\nEncounter-specific wave configurations\nWave announcement UI\nSpawn position variety (center, flanks, behind)\n\n\nTracking\nTech Debt Tracker\nPrioritized issues from codebase audit:\n\n2 Critical issues\n5 High priority issues\nLinked to GitHub Issues (#125-131)\n\n\nSee Also\n\nArchitecture - System integration\nCarriers - Ship Builder V2 system\nCombat - Battle phase breakdown\n"},"internal/reinforcements":{"slug":"internal/reinforcements","filePath":"internal/reinforcements.md","title":"Reinforcement System","links":[],"tags":[],"content":"Reinforcement System\nThe ReinforcementManager controls multi-wave encounters, spawning additional enemies during battles based on various triggers.\n\nWave Triggers\nReinforcements spawn based on these trigger types:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTriggerConditionTURN_THRESHOLDAfter X turns have passedENEMY_CASUALTIESWhen enemy losses exceed thresholdPLAYER_ADVANTAGEWhen player is winning decisivelyCARRIER_DAMAGEWhen enemy carrier takes damageDISTRESS_BEACONEnemy unit with beacon trait calls for helpSCRIPTEDBoss phase transitions\n\nEncounter-Specific Waves\nQuick Encounters\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWavesTimingConfig0N/ANo reinforcements\nShort battles with no additional spawns.\nStandard Encounters\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWavesTimingConfig0-1Turn 4-62 fighters\nBasic encounters may spawn one small wave mid-battle.\nAmbush Encounters\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWavesTimingConfig1-2Turns 3-5, 7-93 fighters per wave\nAmbushes feature aggressive enemies with multiple waves.\nTraits: Aggressive behavior, flanking spawns\nElite Encounters\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWavesTimingConfig1Turn 4-5 OR 50% losses4 fighters\nElites reinforce based on casualties or time.\nTraits: Hunter trait (focuses player carrier)\nBoss Encounters\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWavesTimingConfig2-3Turn 6 OR distress beacon4 fighters per wave\nBoss battles have the most reinforcements.\nTraits: First unit carries distress beacon, triggering additional waves when destroyed.\nFleet Encounters\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWavesTimingConfig1-2Turns 5-7, 10-12Varies\nLarge-scale battles with side spawns.\nSpawn Position: Flanks (left/right edges)\nPursuit Encounters\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWavesTimingConfig1-2Turns 3-4, 6-7Varies\nEnemies chasing the player fleet.\nSpawn Position: Behind player (top of grid)\nMining Encounters\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWavesTimingConfig0-1Turn 6-8May include Miner ships\nResource-focused encounters with potential defender spawns.\nDerelict Encounters\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWavesTimingConfig0Detection-triggeredSpecial wave, 1 turn warning\nExploration encounters that can trigger hostile spawns when investigating.\n\nWave Configuration\nEach wave is configured with:\nclass WaveConfig:\n    var trigger: WaveTrigger\n    var trigger_value: int  # Turn number or casualty %\n    var fighter_count: int\n    var spawn_position: SpawnPosition  # CENTER, FLANKS, BEHIND\n    var trait_weights: Dictionary  # {trait: weight}\nSpawn Positions\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPositionGrid LocationCENTERTop center of gridFLANKSLeft and right edgesBEHINDBehind player (bottom for enemy, top for player)\nCarrier Trait Weights\nEach encounter type has weighted traits for spawned carriers:\n# Ambush encounters\nvar AMBUSH_CARRIER_TRAITS = {\n    &quot;AGGRESSIVE&quot;: 0.6,\n    &quot;HUNTER&quot;: 0.3,\n    &quot;SUICIDAL&quot;: 0.1\n}\n \n# Boss encounters\nvar BOSS_CARRIER_TRAITS = {\n    &quot;DEFENSIVE&quot;: 0.4,\n    &quot;AGGRESSIVE&quot;: 0.3,\n    &quot;HUNTER&quot;: 0.2,\n    &quot;CAUTIOUS&quot;: 0.1\n}\n\nWave Announcement UI\nWhen reinforcements spawn, a WaveAnnouncement component displays:\n\nWarning flash (1 turn before)\n“REINFORCEMENTS INCOMING” banner\nEnemy count and spawn direction\nWave number (e.g., “Wave 2 of 3”)\n\n\nIntegration Points\nBattle Screen\n# In battle_screen.gd\nvar reinforcement_manager: ReinforcementManager\n \nfunc _on_turn_ended(turn: int) -&gt; void:\n    var spawns = reinforcement_manager.check_triggers(turn)\n    for spawn in spawns:\n        _spawn_enemy_wave(spawn)\nEnemy Carrier\n# In enemy_carrier.gd\nfunc _on_fighter_destroyed(fighter: Enemy) -&gt; void:\n    if fighter.has_trait(&quot;DISTRESS_BEACON&quot;):\n        reinforcement_manager.trigger_beacon()\nGameState\n# Encounter setup\nfunc setup_encounter(encounter_type: String) -&gt; void:\n    reinforcement_manager.configure_for_encounter(encounter_type)\n\nBalance Considerations\n\nEarly waves are smaller (1-2 fighters)\nLater waves scale with encounter difficulty\nBoss encounters always have distress beacon trigger\nTotal reinforcement count capped per encounter type\nSpawn position rotates to prevent predictable camping\n"},"internal/tech-debt":{"slug":"internal/tech-debt","filePath":"internal/tech-debt.md","title":"Tech Debt Tracker","links":["developer-guide/save-system","developer-guide/combat-system","developer-guide/screens","game-design/pilots","game-design/squadrons","game-design/balance"],"tags":[],"content":"Tech Debt Tracker\nThis page tracks technical debt identified during the codebase audit. Issues are linked to GitHub Issues for sprint planning.\nPriority Legend\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPriorityDescriptionSLACriticalBugs affecting gameplay/dataFix immediatelyHighSignificant issuesThis sprintMediumCode quality, future riskNext sprintLowNice to haveBacklog\n\nCritical Issues (3)\n1. Pilot survival chance unclamped\nLocation: game_state.gd:1938-1948\nGitHub Issue: #125\nProblem: survival_chance can exceed 1.0, causing 100% survival rate.\n# Current code\nvar survival_chance = GameState.get_admiral_skill_value(&quot;pilot_survival_chance&quot;)\nif randf() &lt; survival_chance:  # Can be &gt; 1.0!\n    # Pilot survives\nFix:\nvar survival_chance = clampf(\n    GameState.get_admiral_skill_value(&quot;pilot_survival_chance&quot;),\n    0.0, 1.0\n)\n\n2. Minimum map size unvalidated\nLocation: battle_map_generator.gd:150-196\nGitHub Issue: #126\nProblem: Maps smaller than 6×7 break spawn zone calculations.\nImpact: Potential crash or invalid spawns on small maps.\nFix: Add validation in map generation:\nassert(width &gt;= 6 and height &gt;= 7, &quot;Map too small for spawn zones&quot;)\n\n3. Sequential combat contradicts GDD\nLocation: combat_resolver.gd:147-224\nGitHub Issue: #134\nProblem: Original GDD specifies “simultaneous” combat, but implementation is sequential (initiative-based).\nDecision needed: Update GDD to match implementation, or change implementation to match GDD.\nRecommendation: Keep sequential combat (more tactical depth), update GDD v1.0 to document this as intentional divergence.\n\nHigh Priority Issues (6)\n4. Missing null safety\nLocations: Multiple files\nGitHub Issue: #135\nProblem: Many method calls lack null checks before invocation.\nPattern:\n# Bad\nsquadron.take_damage(5)\n \n# Good\nif squadron and is_instance_valid(squadron):\n    squadron.take_damage(5)\n\n5. Static ID counter race conditions\nLocation: squadron.gd, pilot.gd\nGitHub Issue: #127\nProblem: Static ID counters (_next_id) not synced after save load, risking ID collisions.\nFix: After loading, sync counters:\nSquadron._next_id = loaded_squadrons.map(func(s): return s.id).max() + 1\n\n6. Modal cleanup on screen exit\nLocation: battle_screen.gd:266-276\nGitHub Issue: #128\nProblem: Modals not cleaned up when exiting battle screen, potential memory leak.\nFix: Add _exit_tree() cleanup:\nfunc _exit_tree() -&gt; void:\n    for modal in active_modals:\n        if is_instance_valid(modal):\n            modal.queue_free()\n\n7. Race condition in screen transitions\nLocation: main.gd:84-90\nGitHub Issue: #129\nProblem: Double-click can trigger multiple transitions, overwriting destination.\nFix: Add transition lock:\nvar is_transitioning: bool = false\n \nfunc _on_screen_change_requested(name: String, params: Dictionary) -&gt; void:\n    if is_transitioning: return\n    is_transitioning = true\n    await _transition_to_screen(name, params)\n    is_transitioning = false\n\n8. Infinite loop in asteroid placement\nLocation: battle_map_generator.gd:643-676\nGitHub Issue: #130\nProblem: No max iteration guard in asteroid placement loop.\nFix: Add iteration limit:\nvar max_attempts = 100\nvar attempts = 0\nwhile not placed and attempts &lt; max_attempts:\n    attempts += 1\n    # ... placement logic\n\n9. Save migration version jumps\nLocation: save_manager.gd:71-150\nGitHub Issue: #131\nProblem: v1→v6 jumps may skip intermediate migrations.\nFix: Apply migrations sequentially:\nwhile version &lt; CURRENT_VERSION:\n    data = _apply_migration(data, version)\n    version += 1\n\nMedium Priority Issues (10+)\nMagic numbers throughout codebase\nLocations: Multiple files\nGitHub Issue: #136\nHardcoded values should be extracted to named constants. Examples:\n\nMorale thresholds (80, 20)\nXP values (25, 50, 10)\nResource amounts\nDamage modifiers\n\n\nIncomplete type hints\nLocations: game_state.gd, squadron.gd\nGitHub Issue: #137\nPublic APIs lack return type hints:\n# Current\nfunc get_adjacent_cells(pos):\n \n# Should be\nfunc get_adjacent_cells(pos: Vector2i) -&gt; Array[Vector2i]:\n\nDebug prints in production\nLocation: carrier.gd\nGitHub Issue: #138\nPrint statements left in production code.\n\nInconsistent RNG seeding\nLocation: Multiple procedural generators\nGitHub Issue: #139\nMix of instance vs function-scoped RNG causing inconsistent reproducibility.\n\nAsymmetric can_attack logic\nLocation: squadron.gd\nGitHub Issue: #140\nMiners handled differently from other types in attack validation.\n\nDocumentation Gaps\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nGapStatusSave format schemaDocumented in Save SystemCombat flowDocumented in Combat SystemState machine diagramsDocumented in Screen NavigationPerk stacking rulesDocumented in Pilot SystemFCN mechanicDocumented in Squadron TypesGeneration tuning guidePartially in Balance Constants\n\nGDD Divergences\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nDivergenceResolution3 squadrons → 7 squadronsGDD v1.0 updated1-2 upgrades → 22 upgradesGDD v1.0 updatedSimultaneous → Sequential combatGDD v1.0 updated, documented as intentionalGrid 5×7 → 7×8 defaultGDD v1.0 updated\n\nLast updated: 2026-01-19"}}